<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252" /><link rel="stylesheet" href="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /><title>Function details for Discharge_sm>Discharge_sm.dischargeTop</title><link rel="stylesheet" href="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">Discharge_sm>Discharge_sm.dischargeTop (34003 calls, 4.527 sec)</span><br/><i>Generated 24-Mar-2015 14:23:40 using cpu time.</i><br/>subfunction in file D:\REPOS\QUant\Discharge_sm.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file25.html">Discharge_sm>Discharge_sm.Discharge_sm</a></td><td class="td-linebottomrt">subfunction</td><td class="td-linebottomrt">34003</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line407">407</a></td><td class="td-linebottomrt"><pre>if idxTop(jj)~=0</pre></td><td class="td-linebottomrt">5236462</td><td class="td-linebottomrt">0.979 s</td><td class="td-linebottomrt" class="td-linebottomrt">21.6%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=22 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line410">410</a></td><td class="td-linebottomrt"><pre>end</pre></td><td class="td-linebottomrt">5236462</td><td class="td-linebottomrt">0.953 s</td><td class="td-linebottomrt" class="td-linebottomrt">21.1%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=21 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line408">408</a></td><td class="td-linebottomrt"><pre>qtop(jj)=deltat(jj).*xprod(idx...</pre></td><td class="td-linebottomrt">4862429</td><td class="td-linebottomrt">0.940 s</td><td class="td-linebottomrt" class="td-linebottomrt">20.8%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=21 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line409">409</a></td><td class="td-linebottomrt"><pre>end</pre></td><td class="td-linebottomrt">4862429</td><td class="td-linebottomrt">0.889 s</td><td class="td-linebottomrt" class="td-linebottomrt">19.6%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=20 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line405">405</a></td><td class="td-linebottomrt"><pre>qtop=nan(1,nens);</pre></td><td class="td-linebottomrt">34003</td><td class="td-linebottomrt">0.284 s</td><td class="td-linebottomrt" class="td-linebottomrt">6.3%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=6 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">0.482 s</td><td class="td-linebottomrt">10.6%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=11 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">4.527 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/>No children<div class="grayline"/><strong>Code Analyzer results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>Show coverage for parent directory <br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">78</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">31</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">47</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">11</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">36</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">23.40 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/>               <span style="color: #A0A0A0"> 389</span> <span style="color: #A0A0A0; background: #FFFFFF;">        function qtop=dischargeTop(topRng,idxTop,idxTop3,topMethod,exponent,xprod,z,cellSize,cellDepth,depthEns,deltat)</span><br/>               <span style="color: #A0A0A0"> 390</span> <span style="color: #228B22; background: #FFFFFF;">            %</span><br/>               <span style="color: #A0A0A0"> 391</span> <span style="color: #228B22; background: #FFFFFF;">            % This function computes the extrapolated top discharge using</span><br/>               <span style="color: #A0A0A0"> 392</span> <span style="color: #228B22; background: #FFFFFF;">            % either constant or power or 3-pt methods.</span><br/>               <span style="color: #A0A0A0"> 393</span> <span style="color: #228B22; background: #FFFFFF;">            %==================================================================</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  34003 </span><span style="color: #000000; font-weight: bold"> 394</span> <span style="color: #000000; background: #FFFFFF;">            switch topMethod </span><br/>               <span style="color: #A0A0A0"> 395</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">  34003 </span><span style="color: #000000; font-weight: bold"> 396</span> <span style="color: #000000; background: #FFFFFF;">                case 0 %'Power' </span><br/>               <span style="color: #A0A0A0"> 397</span> <span style="color: #228B22; background: #FFFFFF;">                    </span><br/>               <span style="color: #A0A0A0"> 398</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    coef=((exponent+1).*nansum(xprod.*cellSize))./...</span><br/>               <span style="color: #A0A0A0"> 399</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        nansum(((z+0.5.*cellSize).^(exponent+1))-((z-0.5.*cellSize).^(exponent+1)));</span><br/>               <span style="color: #A0A0A0"> 400</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    qtop=deltat.*(coef./(exponent+1)).*(depthEns.^(exponent+1)-(depthEns-topRng).^(exponent+1));</span><br/>               <span style="color: #A0A0A0"> 401</span> <span style="color: #228B22; background: #FFFFFF;">                    </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">  34003 </span><span style="color: #000000; font-weight: bold"> 402</span> <span style="color: #000000; background: #FFFFFF;">                case 1 %'Constant' </span><br/>               <span style="color: #A0A0A0"> 403</span> <span style="color: #228B22; background: #FFFFFF;">                    </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">  34003 </span><span style="color: #000000; font-weight: bold"> 404</span> <span style="color: #000000; background: #FFFFFF;">                    nens=length(deltat); </span><br/><span style="color: #FF0000">  0.28 </span><span style="color: #0000FF">  34003 </span><span style="color: #000000; font-weight: bold"> 405</span> <a name="Line405"></a><span style="color: #000000; background: #FFE2E2;">                    qtop=nan(1,nens); </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">  34003 </span><span style="color: #000000; font-weight: bold"> 406</span> <span style="color: #000000; background: #FFFFFF;">                    for jj=1:nens </span><br/><span style="color: #FF0000">  0.98 </span><span style="color: #0000FF">5236462 </span><span style="color: #000000; font-weight: bold"> 407</span> <a name="Line407"></a><span style="color: #000000; background: #FF8080;">                        if idxTop(jj)~=0 </span><br/><span style="color: #FF0000">  0.94 </span><span style="color: #0000FF">4862429 </span><span style="color: #000000; font-weight: bold"> 408</span> <a name="Line408"></a><span style="color: #000000; background: #FF8080;">                            qtop(jj)=deltat(jj).*xprod(idxTop(jj),jj).*topRng(jj); </span><br/><span style="color: #FF0000">  0.89 </span><span style="color: #0000FF">4862429 </span><span style="color: #000000; font-weight: bold"> 409</span> <a name="Line409"></a><span style="color: #000000; background: #FF8080;">                        end </span><br/><span style="color: #FF0000">  0.95 </span><span style="color: #0000FF">5236462 </span><span style="color: #000000; font-weight: bold"> 410</span> <a name="Line410"></a><span style="color: #000000; background: #FF8080;">                    end </span><br/>               <span style="color: #A0A0A0"> 411</span> <span style="color: #228B22; background: #FFFFFF;">                    </span><br/>               <span style="color: #A0A0A0"> 412</span> <span style="color: #A0A0A0; background: #FFFFFF;">                case 2 %'3-Point'</span><br/>               <span style="color: #A0A0A0"> 413</span> <span style="color: #228B22; background: #FFFFFF;">                    </span><br/>               <span style="color: #A0A0A0"> 414</span> <span style="color: #228B22; background: #FFFFFF;">                    % Determine number of bins available in each profile</span><br/>               <span style="color: #A0A0A0"> 415</span> <span style="color: #228B22; background: #FFFFFF;">                    % --------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 416</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    nbins=ones(size(xprod));</span><br/>               <span style="color: #A0A0A0"> 417</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    nbins(isnan(xprod))=0;</span><br/>               <span style="color: #A0A0A0"> 418</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    nbins=nansum(nbins);</span><br/>               <span style="color: #A0A0A0"> 419</span> <span style="color: #228B22; background: #FFFFFF;">                    </span><br/>               <span style="color: #A0A0A0"> 420</span> <span style="color: #228B22; background: #FFFFFF;">                    % 3-pt is only applied to profiles with more than 6</span><br/>               <span style="color: #A0A0A0"> 421</span> <span style="color: #228B22; background: #FFFFFF;">                    % bins, otherwise constant is used</span><br/>               <span style="color: #A0A0A0"> 422</span> <span style="color: #228B22; background: #FFFFFF;">                    % -------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 423</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    idxconstant=ones(size(nbins));</span><br/>               <span style="color: #A0A0A0"> 424</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    idxconstant(nbins&gt;5)=0;</span><br/>               <span style="color: #A0A0A0"> 425</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    idx3pt=~idxconstant;</span><br/>               <span style="color: #A0A0A0"> 426</span> <span style="color: #228B22; background: #FFFFFF;">                    </span><br/>               <span style="color: #A0A0A0"> 427</span> <span style="color: #228B22; background: #FFFFFF;">                    % Compute constant fit where appropriate</span><br/>               <span style="color: #A0A0A0"> 428</span> <span style="color: #228B22; background: #FFFFFF;">                    % --------------------------------------</span><br/>               <span style="color: #A0A0A0"> 429</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    deltatC=deltat;</span><br/>               <span style="color: #A0A0A0"> 430</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    deltatC(idx3pt)=nan;</span><br/>               <span style="color: #A0A0A0"> 431</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    nens=length(deltat);</span><br/>               <span style="color: #A0A0A0"> 432</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    qtopC=zeros(1,nens);</span><br/>               <span style="color: #A0A0A0"> 433</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    for jj=1:nens</span><br/>               <span style="color: #A0A0A0"> 434</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        if idxTop(jj)~=0</span><br/>               <span style="color: #A0A0A0"> 435</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            qtopC(jj)=deltatC(jj).*xprod(idxTop(jj),jj).*topRng(jj);</span><br/>               <span style="color: #A0A0A0"> 436</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/>               <span style="color: #A0A0A0"> 437</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0"> 438</span> <span style="color: #228B22; background: #FFFFFF;">                    </span><br/>               <span style="color: #A0A0A0"> 439</span> <span style="color: #228B22; background: #FFFFFF;">                    % Compute 3-pt fit using linear least squares fit of</span><br/>               <span style="color: #A0A0A0"> 440</span> <span style="color: #228B22; background: #FFFFFF;">                    % top 3 valid bins</span><br/>               <span style="color: #A0A0A0"> 441</span> <span style="color: #228B22; background: #FFFFFF;">                    % ---------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 442</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    qtop3=zeros(1,nens);</span><br/>               <span style="color: #A0A0A0"> 443</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    deltat3=deltat;</span><br/>               <span style="color: #A0A0A0"> 444</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    deltat3(logical(idxconstant))=0;</span><br/>               <span style="color: #A0A0A0"> 445</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    for jj=1:nens</span><br/>               <span style="color: #A0A0A0"> 446</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        if idx3pt(jj)==1</span><br/>               <span style="color: #A0A0A0"> 447</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            sumd=nansum(cellDepth(idxTop3(1:3,jj),jj));</span><br/>               <span style="color: #A0A0A0"> 448</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            sumd2=nansum(cellDepth(idxTop3(1:3,jj),jj).^2);</span><br/>               <span style="color: #A0A0A0"> 449</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            sumQ=nansum(xprod(idxTop3(1:3,jj),jj));</span><br/>               <span style="color: #A0A0A0"> 450</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            sumQd=nansum(xprod(idxTop3(1:3,jj),jj).*cellDepth(idxTop3(1:3,jj),jj));</span><br/>               <span style="color: #A0A0A0"> 451</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            delta=3*sumd2-sumd.^2;</span><br/>               <span style="color: #A0A0A0"> 452</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            A=(3.*sumQd-sumQ.*sumd)./delta;</span><br/>               <span style="color: #A0A0A0"> 453</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            B=(sumQ.*sumd2-sumQd.*sumd)./delta;</span><br/>               <span style="color: #A0A0A0"> 454</span> <span style="color: #228B22; background: #FFFFFF;">                            </span><br/>               <span style="color: #A0A0A0"> 455</span> <span style="color: #228B22; background: #FFFFFF;">                            % Compute discharge for 3-pt fit</span><br/>               <span style="color: #A0A0A0"> 456</span> <span style="color: #228B22; background: #FFFFFF;">                            % ------------------------------</span><br/>               <span style="color: #A0A0A0"> 457</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            Qo=(A.*topRng(jj).^2)./2+B.*topRng(jj);</span><br/>               <span style="color: #A0A0A0"> 458</span> <span style="color: #A0A0A0; background: #FFFFFF;">                            qtop3(jj)=deltat3(jj).*Qo;</span><br/>               <span style="color: #A0A0A0"> 459</span> <span style="color: #A0A0A0; background: #FFFFFF;">                        end</span><br/>               <span style="color: #A0A0A0"> 460</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    end</span><br/>               <span style="color: #A0A0A0"> 461</span> <span style="color: #228B22; background: #FFFFFF;">                    </span><br/>               <span style="color: #A0A0A0"> 462</span> <span style="color: #228B22; background: #FFFFFF;">                    % Combine constant and 3-pt discharges</span><br/>               <span style="color: #A0A0A0"> 463</span> <span style="color: #228B22; background: #FFFFFF;">                    % ------------------------------------</span><br/>               <span style="color: #A0A0A0"> 464</span> <span style="color: #A0A0A0; background: #FFFFFF;">                    qtop=nansum(qtop3)+nansum(qtopC);</span><br/>               <span style="color: #A0A0A0"> 465</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  34003 </span><span style="color: #000000; font-weight: bold"> 466</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>