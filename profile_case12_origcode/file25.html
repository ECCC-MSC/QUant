<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252" /><link rel="stylesheet" href="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /><title>Function details for Discharge_sm>Discharge_sm.Discharge_sm</title><link rel="stylesheet" href="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">Discharge_sm>Discharge_sm.Discharge_sm (17001 calls, 188.224 sec)</span><br/><i>Generated 24-Mar-2015 14:22:27 using cpu time.</i><br/>subfunction in file D:\REPOS\QUant\Discharge_sm.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file7.html">simulate_uncertainty</a></td><td class="td-linebottomrt">script</td><td class="td-linebottomrt">17001</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line289">289</a></td><td class="td-linebottomrt"><pre>qIntCellsCells=obj.dischargeIn...</pre></td><td class="td-linebottomrt">17001</td><td class="td-linebottomrt">29.239 s</td><td class="td-linebottomrt" class="td-linebottomrt">15.5%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=16 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line228">228</a></td><td class="td-linebottomrt"><pre>vel2 = sqrt(wVelx.^2 + wVely.^...</pre></td><td class="td-linebottomrt">17001</td><td class="td-linebottomrt">21.389 s</td><td class="td-linebottomrt" class="td-linebottomrt">11.4%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=11 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line313">313</a></td><td class="td-linebottomrt"><pre>[obj.right] = obj.dischargeEdg...</pre></td><td class="td-linebottomrt">17001</td><td class="td-linebottomrt">13.824 s</td><td class="td-linebottomrt" class="td-linebottomrt">7.3%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=7 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line306">306</a></td><td class="td-linebottomrt"><pre>qBotEns=obj.dischargeBot(botRn...</pre></td><td class="td-linebottomrt">17001</td><td class="td-linebottomrt">13.720 s</td><td class="td-linebottomrt" class="td-linebottomrt">7.3%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=7 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line333">333</a></td><td class="td-linebottomrt"><pre>qBotNIens=obj.dischargeBot(bot...</pre></td><td class="td-linebottomrt">17001</td><td class="td-linebottomrt">13.193 s</td><td class="td-linebottomrt" class="td-linebottomrt">7.0%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=7 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">96.859 s</td><td class="td-linebottomrt">51.5%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=51 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">188.224 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file109.html">...rge_sm>Discharge_sm.dischargeIntcells</a></td><td class="td-linebottomrt">subfunction</td><td class="td-linebottomrt">17002</td><td class="td-linebottomrt">28.548 s</td><td class="td-linebottomrt">15.2%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=15 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file110.html">Discharge_sm>Discharge_sm.dischargeBot</a></td><td class="td-linebottomrt">subfunction</td><td class="td-linebottomrt">34003</td><td class="td-linebottomrt">25.729 s</td><td class="td-linebottomrt">13.7%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=14 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file117.html">Discharge_sm>Discharge_sm.dischargeEdge</a></td><td class="td-linebottomrt">subfunction</td><td class="td-linebottomrt">34002</td><td class="td-linebottomrt">25.421 s</td><td class="td-linebottomrt">13.5%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=14 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file296.html">Discharge_sm>Discharge_sm.dischargeTop</a></td><td class="td-linebottomrt">subfunction</td><td class="td-linebottomrt">34003</td><td class="td-linebottomrt">4.527 s</td><td class="td-linebottomrt">2.4%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file299.html">random</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">51003</td><td class="td-linebottomrt">3.541 s</td><td class="td-linebottomrt">1.9%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=2 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file118.html">nansum</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">170016</td><td class="td-linebottomrt">2.679 s</td><td class="td-linebottomrt">1.4%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file112.html">repmat</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">85006</td><td class="td-linebottomrt">2.218 s</td><td class="td-linebottomrt">1.2%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file89.html">nancumsum</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">17001</td><td class="td-linebottomrt">2.057 s</td><td class="td-linebottomrt">1.1%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file287.html">nanmean</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">34003</td><td class="td-linebottomrt">1.077 s</td><td class="td-linebottomrt">0.6%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=1 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file224.html">colorbar</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.094 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file122.html">pcolor</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.017 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file78.html">subplot</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.017 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file123.html">xlabel</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.003 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file125.html">title</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.002 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file124.html">ylabel</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.002 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file163.html">newplot</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.001 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file43.html">shading</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0.001 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file121.html">hold</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">3</td><td class="td-linebottomrt">0.001 s</td><td class="td-linebottomrt">0.0%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file107.html">fliplr</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">8</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file184.html">lineseries</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file26.html">initprintexporttemplate</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">1</td><td class="td-linebottomrt">0 s</td><td class="td-linebottomrt">0%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">92.291 s</td><td class="td-linebottomrt">49.0%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=49 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">188.224 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line39">39</a></td><td class="td-linebottomrt"><span class="mono">Using ISEMPTY is usually faster than comparing LENGTH to 0.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line87">87</a></td><td class="td-linebottomrt"><span class="mono">Use STRCMP instead of == or ~= to compare strings.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line92">92</a></td><td class="td-linebottomrt"><span class="mono">Use STRCMP instead of == or ~= to compare strings.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line97">97</a></td><td class="td-linebottomrt"><span class="mono">Use STRCMP instead of == or ~= to compare strings.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line106">106</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'ensDeltaTimeadj2' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line170">170</a></td><td class="td-linebottomrt"><span class="mono">The variable 'topRng' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line172">172</a></td><td class="td-linebottomrt"><span class="mono">The variable 'botRng' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line176">176</a></td><td class="td-linebottomrt"><span class="mono">The variable 'topRng' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line177">177</a></td><td class="td-linebottomrt"><span class="mono">The variable 'botRng' appears to change size on every loop iteration. Consider preallocating for speed.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>Show coverage for parent directory <br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">355</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">184</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">171</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">152</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">19</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">88.89 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/><span style="color: #FF0000">  0.17 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  31</span> <span style="color: #000000; background: #FFFFFF;">        function obj=Discharge_sm(useData, navRef, show, varargin) </span><br/>               <span style="color: #A0A0A0">  32</span> <span style="color: #228B22; background: #FFFFFF;">            % show is for displyaing the measurements, you don't want it to do it each</span><br/>               <span style="color: #A0A0A0">  33</span> <span style="color: #228B22; background: #FFFFFF;">            % time the monte carlo simulation is run</span><br/>               <span style="color: #A0A0A0">  34</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0">  35</span> <span style="color: #228B22; background: #FFFFFF;">            % navRef = 'gga', 'vtg' or 'bot'</span><br/>               <span style="color: #A0A0A0">  36</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0">  37</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0">  38</span> <span style="color: #228B22; background: #FFFFFF;">            % if you want to add uncertainty in the edge estimates</span><br/><a name="Line39"></a><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  39</span> <span style="color: #000000; background: #FFFFFF;">            if length(varargin) &gt; 0 </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  40</span> <span style="color: #000000; background: #FFFFFF;">                varyLEV = varargin{1}; </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  41</span> <span style="color: #000000; background: #FFFFFF;">                varyREV = varargin{2}; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  42</span> <span style="color: #000000; background: #FFFFFF;">                varyQEXTPTB = varargin{3}; </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  43</span> <span style="color: #000000; background: #FFFFFF;">                varyQINTENS = varargin{4}; </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  44</span> <span style="color: #000000; background: #FFFFFF;">                forQintUncert = varargin{5}; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  45</span> <span style="color: #228B22; background: #FFFFFF;">            else </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  46</span> <span style="color: #000000; background: #FFFFFF;">                varyLEV = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  47</span> <span style="color: #000000; background: #FFFFFF;">                varyREV = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  48</span> <span style="color: #000000; background: #FFFFFF;">                varyQEXTPTB = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  49</span> <span style="color: #000000; background: #FFFFFF;">                varyQINTENS = 0; </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  50</span> <span style="color: #000000; background: #FFFFFF;">                forQintUncert = 0; </span><br/>               <span style="color: #A0A0A0">  51</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold">  52</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/><span style="color: #FF0000">  0.51 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  53</span> <span style="color: #000000; background: #FFFFFF;">            obj.navRef = navRef; </span><br/>               <span style="color: #A0A0A0">  54</span> <span style="color: #228B22; background: #FFFFFF;">           </span><br/>               <span style="color: #A0A0A0">  55</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.09 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  56</span> <span style="color: #000000; background: #FFFFFF;">            if strcmp(useData.topMethod, 'Power'); </span><br/>               <span style="color: #A0A0A0">  57</span> <span style="color: #A0A0A0; background: #FFFFFF;">                topMethod = 0;</span><br/><span style="color: #FF0000">  0.09 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  58</span> <span style="color: #000000; background: #FFFFFF;">            elseif strcmp(useData.topMethod, 'Constant'); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  59</span> <span style="color: #000000; background: #FFFFFF;">                topMethod = 1; </span><br/>               <span style="color: #A0A0A0">  60</span> <span style="color: #A0A0A0; background: #FFFFFF;">            elseif strcmp(useData.topMethod, '3-point');</span><br/>               <span style="color: #A0A0A0">  61</span> <span style="color: #A0A0A0; background: #FFFFFF;">                topMethod = 2;</span><br/>               <span style="color: #A0A0A0">  62</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0">  63</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/><span style="color: #FF0000">  0.08 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  64</span> <span style="color: #000000; background: #FFFFFF;">            if strcmp(useData.botMethod, 'Power'); </span><br/>               <span style="color: #A0A0A0">  65</span> <span style="color: #A0A0A0; background: #FFFFFF;">                botMethod = 0;</span><br/><span style="color: #FF0000">  0.07 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  66</span> <span style="color: #000000; background: #FFFFFF;">            elseif strcmp(useData.botMethod, 'No Slip'); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  67</span> <span style="color: #000000; background: #FFFFFF;">                botMethod = 2; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  68</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/>               <span style="color: #A0A0A0">  69</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0">  70</span> <span style="color: #228B22; background: #FFFFFF;">         </span><br/>               <span style="color: #A0A0A0">  71</span> <span style="color: #228B22; background: #FFFFFF;">            % If NOT using extrap3.m</span><br/>               <span style="color: #A0A0A0">  72</span> <span style="color: #228B22; background: #FFFFFF;">           % topMethod = useData.topMethod</span><br/>               <span style="color: #A0A0A0">  73</span> <span style="color: #228B22; background: #FFFFFF;">           % botMethod = useData.botMethod</span><br/>               <span style="color: #A0A0A0">  74</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  75</span> <span style="color: #000000; background: #FFFFFF;">            exponent = useData.exponent; </span><br/>               <span style="color: #A0A0A0">  76</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0">  77</span> <span style="color: #228B22; background: #FFFFFF;">            % if you want to display file name, remove the semicolon</span><br/>               <span style="color: #A0A0A0">  78</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.97 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  79</span> <span style="color: #000000; background: #FFFFFF;">            useData.filename; </span><br/>               <span style="color: #A0A0A0">  80</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0">  81</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0">  82</span> <span style="color: #228B22; background: #FFFFFF;">            % Assign variables from input data to local variables.</span><br/>               <span style="color: #A0A0A0">  83</span> <span style="color: #228B22; background: #FFFFFF;">            % ----------------------------------------------------</span><br/><span style="color: #FF0000">  0.08 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  84</span> <span style="color: #000000; background: #FFFFFF;">            cellSize=useData.cellSize; </span><br/><span style="color: #FF0000">  0.08 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  85</span> <span style="color: #000000; background: #FFFFFF;">            cellDepth=useData.cellDepth; </span><br/>               <span style="color: #A0A0A0">  86</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><a name="Line87"></a><span style="color: #FF0000">  0.07 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  87</span> <span style="color: #000000; background: #FFFFFF;">            if navRef == 'bot' </span><br/><span style="color: #FF0000">  0.09 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  88</span> <span style="color: #000000; background: #FFFFFF;">                wVelx=useData.wVelx; </span><br/><span style="color: #FF0000">  0.07 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  89</span> <span style="color: #000000; background: #FFFFFF;">                wVely=useData.wVely; </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  90</span> <span style="color: #000000; background: #FFFFFF;">                bVelx=useData.btVel(1,:); </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold">  91</span> <span style="color: #000000; background: #FFFFFF;">                bVely=useData.btVel(2,:); </span><br/><a name="Line92"></a>               <span style="color: #A0A0A0">  92</span> <span style="color: #A0A0A0; background: #FFFFFF;">            elseif navRef == 'gga'</span><br/>               <span style="color: #A0A0A0">  93</span> <span style="color: #A0A0A0; background: #FFFFFF;">                wVelx = useData.wVelx_reGGA;</span><br/>               <span style="color: #A0A0A0">  94</span> <span style="color: #A0A0A0; background: #FFFFFF;">                wVely = useData.wVely_reGGA;</span><br/>               <span style="color: #A0A0A0">  95</span> <span style="color: #A0A0A0; background: #FFFFFF;">                bVelx = useData.btVel_reGGA(1,:);</span><br/>               <span style="color: #A0A0A0">  96</span> <span style="color: #A0A0A0; background: #FFFFFF;">                bVely = useData.btVel_reGGA(2,:);</span><br/><a name="Line97"></a>               <span style="color: #A0A0A0">  97</span> <span style="color: #A0A0A0; background: #FFFFFF;">            elseif navRef == 'vtg'</span><br/>               <span style="color: #A0A0A0">  98</span> <span style="color: #A0A0A0; background: #FFFFFF;">                wVelx = useData.wVelx_reVTG;</span><br/>               <span style="color: #A0A0A0">  99</span> <span style="color: #A0A0A0; background: #FFFFFF;">                wVely = useData.wVely_reVTG;</span><br/>               <span style="color: #A0A0A0"> 100</span> <span style="color: #A0A0A0; background: #FFFFFF;">                bVelx = useData.btVel_reVTG(1,:);</span><br/>               <span style="color: #A0A0A0"> 101</span> <span style="color: #A0A0A0; background: #FFFFFF;">                bVely = useData.btVel_reVTG(2,:);</span><br/>               <span style="color: #A0A0A0"> 102</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 103</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.08 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 104</span> <span style="color: #000000; background: #FFFFFF;">            depthEns=useData.depthEns; </span><br/><span style="color: #FF0000">  0.10 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 105</span> <span style="color: #000000; background: #FFFFFF;">            ensDeltaTimeadj = useData.ensDeltaTime; </span><br/><a name="Line106"></a><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 106</span> <span style="color: #000000; background: #FFFFFF;">            ensDeltaTimeadj2 = useData.ensDeltaTime; </span><br/><span style="color: #FF0000">  0.08 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 107</span> <span style="color: #000000; background: #FFFFFF;">            ensDeltaTime=useData.ensDeltaTime; </span><br/>               <span style="color: #A0A0A0"> 108</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 109</span> <span style="color: #000000; background: #FFFFFF;">            numEns=useData.numEns; </span><br/><span style="color: #FF0000">  0.08 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 110</span> <span style="color: #000000; background: #FFFFFF;">            startEdge=useData.startBank; </span><br/>               <span style="color: #A0A0A0"> 111</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 112</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 113</span> <span style="color: #000000; background: #FFFFFF;">            leftDist = useData.lDist; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 114</span> <span style="color: #000000; background: #FFFFFF;">            rightDist = useData.rDist; </span><br/>               <span style="color: #A0A0A0"> 115</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 116</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 117</span> <span style="color: #000000; background: #FFFFFF;">            leftCoef = useData.leftCoef; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 118</span> <span style="color: #000000; background: #FFFFFF;">            leftNumEns2Avg = useData.leftNumEns2Avg; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 119</span> <span style="color: #000000; background: #FFFFFF;">            rightCoef = useData.rightCoef; % </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 120</span> <span style="color: #000000; background: #FFFFFF;">            rightNumEns2Avg = useData.rightNumEns2Avg; </span><br/>               <span style="color: #A0A0A0"> 121</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 122</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 123</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 124</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 125</span> <span style="color: #228B22; background: #FFFFFF;">            % Compute / initialize local variables</span><br/>               <span style="color: #A0A0A0"> 126</span> <span style="color: #228B22; background: #FFFFFF;">            % ------------------------------------</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 127</span> <span style="color: #000000; background: #FFFFFF;">            k=0; </span><br/><span style="color: #FF0000">  1.03 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 128</span> <span style="color: #000000; background: #FFFFFF;">            z=<a href="file112.html">repmat</a>(depthEns,size(cellDepth,1),1)-cellDepth; </span><br/><span style="color: #FF0000">  0.36 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 129</span> <span style="color: #000000; background: #FFFFFF;">            z(isnan(wVelx))=nan; </span><br/>               <span style="color: #A0A0A0"> 130</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 131</span> <span style="color: #228B22; background: #FFFFFF;">            % Loop to identify first and last valid cell in each ensemble,</span><br/>               <span style="color: #A0A0A0"> 132</span> <span style="color: #228B22; background: #FFFFFF;">            % invalid ensembles, and invalid cells within valid ensembles.</span><br/>               <span style="color: #A0A0A0"> 133</span> <span style="color: #228B22; background: #FFFFFF;">            % The range to the top of the top</span><br/>               <span style="color: #A0A0A0"> 134</span> <span style="color: #228B22; background: #FFFFFF;">            % cell and bottom of the bottom cell is also computed.</span><br/>               <span style="color: #A0A0A0"> 135</span> <span style="color: #228B22; background: #FFFFFF;">            % -----------------------------------------------------------</span><br/><span style="color: #FF0000">  0.12 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 136</span> <span style="color: #000000; background: #FFFFFF;">            lgclIntQCells=true(size(cellSize)); </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 137</span> <span style="color: #000000; background: #FFFFFF;">            idxTop=zeros(1,size(wVelx,2)); </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 138</span> <span style="color: #000000; background: #FFFFFF;">            idxTop3=zeros(3,size(wVelx,2)); </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 139</span> <span style="color: #000000; background: #FFFFFF;">            idxBot=zeros(1,size(wVelx,2)); </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 140</span> <span style="color: #000000; background: #FFFFFF;">            idxValidEns=false(1,size(wVelx,2)); </span><br/>               <span style="color: #A0A0A0"> 141</span> <span style="color: #228B22; background: #FFFFFF;">           </span><br/>               <span style="color: #A0A0A0"> 142</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 143</span> <span style="color: #000000; background: #FFFFFF;">            for jj=1:numEns </span><br/><span style="color: #FF0000">  6.27 </span><span style="color: #0000FF">2618154 </span><span style="color: #000000; font-weight: bold"> 144</span> <span style="color: #000000; background: #FFE2E2;">                test=find(~isnan(wVelx(:,jj)), 1); </span><br/>               <span style="color: #A0A0A0"> 145</span> <span style="color: #228B22; background: #FFFFFF;">                %</span><br/>               <span style="color: #A0A0A0"> 146</span> <span style="color: #228B22; background: #FFFFFF;">                % If entire ensemble has no valid data the ensemble is</span><br/>               <span style="color: #A0A0A0"> 147</span> <span style="color: #228B22; background: #FFFFFF;">                % marked invalid.</span><br/>               <span style="color: #A0A0A0"> 148</span> <span style="color: #228B22; background: #FFFFFF;">                % -----------------------------------------------------</span><br/><span style="color: #FF0000">  2.53 </span><span style="color: #0000FF">2618154 </span><span style="color: #000000; font-weight: bold"> 149</span> <span style="color: #000000; background: #FFFFFF;">                if ~isempty(test) </span><br/><span style="color: #FF0000">  0.38 </span><span style="color: #0000FF">2431143 </span><span style="color: #000000; font-weight: bold"> 150</span> <span style="color: #000000; background: #FFFFFF;">                    idxValidEns(jj)=true; </span><br/><span style="color: #FF0000">  0.45 </span><span style="color: #0000FF">2431143 </span><span style="color: #000000; font-weight: bold"> 151</span> <span style="color: #000000; background: #FFFFFF;">                    k=k+1; </span><br/>               <span style="color: #A0A0A0"> 152</span> <span style="color: #228B22; background: #FFFFFF;">                    </span><br/>               <span style="color: #A0A0A0"> 153</span> <span style="color: #228B22; background: #FFFFFF;">                    % Identify valid top and bottom cell and top 3 cells for</span><br/>               <span style="color: #A0A0A0"> 154</span> <span style="color: #228B22; background: #FFFFFF;">                    % the 3-pt extrapolation method</span><br/>               <span style="color: #A0A0A0"> 155</span> <span style="color: #228B22; background: #FFFFFF;">                    % ------------------------------------------------------</span><br/><span style="color: #FF0000">  8.38 </span><span style="color: #0000FF">2431143 </span><span style="color: #000000; font-weight: bold"> 156</span> <span style="color: #000000; background: #FFE2E2;">                    idxTop(jj)=find(~isnan(wVelx(:,jj)),1,'first'); </span><br/><span style="color: #FF0000">  7.09 </span><span style="color: #0000FF">2431143 </span><span style="color: #000000; font-weight: bold"> 157</span> <span style="color: #000000; background: #FFE2E2;">                    temp=find(~isnan(wVelx(:,jj)),3,'first'); </span><br/><span style="color: #FF0000">  2.49 </span><span style="color: #0000FF">2431143 </span><span style="color: #000000; font-weight: bold"> 158</span> <span style="color: #000000; background: #FFFFFF;">                    if length(temp)&gt;2 </span><br/><span style="color: #FF0000">  1.88 </span><span style="color: #0000FF">2431143 </span><span style="color: #000000; font-weight: bold"> 159</span> <span style="color: #000000; background: #FFFFFF;">                        idxTop3(:,jj)=temp; </span><br/><span style="color: #FF0000">  0.49 </span><span style="color: #0000FF">2431143 </span><span style="color: #000000; font-weight: bold"> 160</span> <span style="color: #000000; background: #FFFFFF;">                    end </span><br/><span style="color: #FF0000">  8.37 </span><span style="color: #0000FF">2431143 </span><span style="color: #000000; font-weight: bold"> 161</span> <span style="color: #000000; background: #FFE2E2;">                    idxBot(jj)=find(~isnan(wVelx(:,jj)),1,'last'); </span><br/>               <span style="color: #A0A0A0"> 162</span> <span style="color: #228B22; background: #FFFFFF;">                    </span><br/>               <span style="color: #A0A0A0"> 163</span> <span style="color: #228B22; background: #FFFFFF;">                    % Identify invalid cells between top and bottom</span><br/>               <span style="color: #A0A0A0"> 164</span> <span style="color: #228B22; background: #FFFFFF;">                    % ---------------------------------------------</span><br/><span style="color: #FF0000">  9.25 </span><span style="color: #0000FF">2431143 </span><span style="color: #000000; font-weight: bold"> 165</span> <span style="color: #000000; background: #FFD4D4;">                    temp=find(isnan(wVelx(idxTop(jj):idxBot(jj),jj)))+idxTop(jj)-1; </span><br/><span style="color: #FF0000">  2.57 </span><span style="color: #0000FF">2431143 </span><span style="color: #000000; font-weight: bold"> 166</span> <span style="color: #000000; background: #FFFFFF;">                    lgclIntQCells(temp,jj)=false; </span><br/>               <span style="color: #A0A0A0"> 167</span> <span style="color: #228B22; background: #FFFFFF;">                    </span><br/>               <span style="color: #A0A0A0"> 168</span> <span style="color: #228B22; background: #FFFFFF;">                    % Compute range for top and bottom extrapolation</span><br/>               <span style="color: #A0A0A0"> 169</span> <span style="color: #228B22; background: #FFFFFF;">                    % ----------------------------------------------</span><br/><a name="Line170"></a><span style="color: #FF0000">  3.09 </span><span style="color: #0000FF">2431143 </span><span style="color: #000000; font-weight: bold"> 170</span> <span style="color: #000000; background: #FFF0F0;">                    topRng(jj)=cellDepth(idxTop(jj),jj)-0.5.*cellSize(idxTop(jj),jj); </span><br/>               <span style="color: #A0A0A0"> 171</span> <span style="color: #228B22; background: #FFFFFF;">                    </span><br/><a name="Line172"></a><span style="color: #FF0000">  2.18 </span><span style="color: #0000FF">2431143 </span><span style="color: #000000; font-weight: bold"> 172</span> <span style="color: #000000; background: #FFFFFF;">                    botRng(jj)=depthEns(jj)-cellDepth(idxBot(jj),jj)-0.5*cellSize(idxBot(jj),jj); </span><br/>               <span style="color: #A0A0A0"> 173</span> <span style="color: #228B22; background: #FFFFFF;">                    </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF"> 187011 </span><span style="color: #000000; font-weight: bold"> 174</span> <span style="color: #228B22; background: #FFFFFF;">                else </span><br/>               <span style="color: #A0A0A0"> 175</span> <span style="color: #228B22; background: #FFFFFF;">                    </span><br/><a name="Line176"></a><span style="color: #FF0000">  0.20 </span><span style="color: #0000FF"> 187011 </span><span style="color: #000000; font-weight: bold"> 176</span> <span style="color: #000000; background: #FFFFFF;">                    topRng(jj)=nan; </span><br/><a name="Line177"></a><span style="color: #FF0000">  0.12 </span><span style="color: #0000FF"> 187011 </span><span style="color: #000000; font-weight: bold"> 177</span> <span style="color: #000000; background: #FFFFFF;">                    botRng(jj)=nan; </span><br/>               <span style="color: #A0A0A0"> 178</span> <span style="color: #228B22; background: #FFFFFF;">                    </span><br/>               <span style="color: #A0A0A0"> 179</span> <span style="color: #228B22; background: #FFFFFF;">                    % The delta time on the next valid ensemble is</span><br/>               <span style="color: #A0A0A0"> 180</span> <span style="color: #228B22; background: #FFFFFF;">                    % increased by the delta time of the invalid ensemble</span><br/>               <span style="color: #A0A0A0"> 181</span> <span style="color: #228B22; background: #FFFFFF;">                    % ---------------------------------------------------</span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF"> 187011 </span><span style="color: #000000; font-weight: bold"> 182</span> <span style="color: #000000; background: #FFFFFF;">                    if jj+1&lt;numEns &amp;&amp; ~isnan(ensDeltaTimeadj(jj)) % if before end of variable and </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF"> 187011 </span><span style="color: #000000; font-weight: bold"> 183</span> <span style="color: #000000; background: #FFFFFF;">                        ensDeltaTimeadj(jj+1)=ensDeltaTimeadj(jj)+ensDeltaTimeadj(jj+1); </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF"> 187011 </span><span style="color: #000000; font-weight: bold"> 184</span> <span style="color: #000000; background: #FFFFFF;">                    end </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF"> 187011 </span><span style="color: #000000; font-weight: bold"> 185</span> <span style="color: #000000; background: #FFFFFF;">                    ensDeltaTimeadj(jj)=nan; </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF"> 187011 </span><span style="color: #000000; font-weight: bold"> 186</span> <span style="color: #000000; background: #FFFFFF;">                end </span><br/><span style="color: #FF0000">  0.61 </span><span style="color: #0000FF">2618154 </span><span style="color: #000000; font-weight: bold"> 187</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/>               <span style="color: #A0A0A0"> 188</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 189</span> <span style="color: #228B22; background: #FFFFFF;">  </span><br/>               <span style="color: #A0A0A0"> 190</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 191</span> <span style="color: #228B22; background: #FFFFFF;">            % want to swap places of the larger ensemble time steps from</span><br/>               <span style="color: #A0A0A0"> 192</span> <span style="color: #228B22; background: #FFFFFF;">            % after the missing ensembles to before, a kind of fliplr for</span><br/>               <span style="color: #A0A0A0"> 193</span> <span style="color: #228B22; background: #FFFFFF;">            % the value surrounding NaNs.</span><br/>               <span style="color: #A0A0A0"> 194</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 195</span> <span style="color: #228B22; background: #FFFFFF;">            % Compute the cross product used in the other computations</span><br/>               <span style="color: #A0A0A0"> 196</span> <span style="color: #228B22; background: #FFFFFF;">            % --------------------------------------------------------</span><br/><span style="color: #FF0000">  1.18 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 197</span> <span style="color: #000000; background: #FFFFFF;">            xprod = ((wVelx.*<a href="file112.html">repmat</a>(bVely,size(wVelx,1),1))-... </span><br/>               <span style="color: #A0A0A0"> 198</span> <span style="color: #000000; background: #FFFFFF;">                (wVely.*repmat(bVelx,size(wVely,1),1)));</span><br/>               <span style="color: #A0A0A0"> 199</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 200</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 201</span> <span style="color: #228B22; background: #FFFFFF;">            % Determine sign of cross product (see p 132 of Stephanie's</span><br/>               <span style="color: #A0A0A0"> 202</span> <span style="color: #228B22; background: #FFFFFF;">            % first uOttawa lab book</span><br/>               <span style="color: #A0A0A0"> 203</span> <span style="color: #228B22; background: #FFFFFF;">            % really, all you want is for the discharge to be positive in</span><br/>               <span style="color: #A0A0A0"> 204</span> <span style="color: #228B22; background: #FFFFFF;">            % the end</span><br/>               <span style="color: #A0A0A0"> 205</span> <span style="color: #228B22; background: #FFFFFF;">            %%%%%%%%%%%%</span><br/>               <span style="color: #A0A0A0"> 206</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 207</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 208</span> <span style="color: #000000; background: #FFFFFF;">            if strcmpi(startEdge,'Left') </span><br/>               <span style="color: #A0A0A0"> 209</span> <span style="color: #A0A0A0; background: #FFFFFF;">                direc=1;</span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 210</span> <span style="color: #228B22; background: #FFFFFF;">            else </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 211</span> <span style="color: #000000; background: #FFFFFF;">                direc=-1; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 212</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/>               <span style="color: #A0A0A0"> 213</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 214</span> <span style="color: #000000; background: #FFFFFF;">            xprod=xprod.*direc; </span><br/>               <span style="color: #A0A0A0"> 215</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 216</span> <span style="color: #228B22; background: #FFFFFF;">            % in case there's something wrong with the mmt file and it</span><br/>               <span style="color: #A0A0A0"> 217</span> <span style="color: #228B22; background: #FFFFFF;">            % can't read the start and end bank correctly, this little</span><br/>               <span style="color: #A0A0A0"> 218</span> <span style="color: #228B22; background: #FFFFFF;">            % cheating works</span><br/>               <span style="color: #A0A0A0"> 219</span> <span style="color: #228B22; background: #FFFFFF;">          </span><br/><span style="color: #FF0000">  1.21 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 220</span> <span style="color: #000000; background: #FFFFFF;">            if <a href="file287.html">nanmean</a>(<a href="file287.html">nanmean</a>(xprod)) &lt; 0 % the wrong start bank was used so the velocities have the wrong sign </span><br/>               <span style="color: #A0A0A0"> 221</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>               <span style="color: #A0A0A0"> 222</span> <span style="color: #A0A0A0; background: #FFFFFF;">                xprod = -xprod;</span><br/>               <span style="color: #A0A0A0"> 223</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 224</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 225</span> <span style="color: #228B22; background: #FFFFFF;">           </span><br/>               <span style="color: #A0A0A0"> 226</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  2.53 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 227</span> <span style="color: #000000; background: #FFFFFF;">            length_refBT =  <a href="file89.html">nancumsum</a>(useData.ensDeltaTime.*(sqrt(useData.btVel(1,:).^2 + (useData.btVel(2,:).^2)))); </span><br/><span style="color: #FF0000"> 21.39 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 228</span> <a name="Line228"></a><span style="color: #000000; background: #FF9C9C;">            vel2 = sqrt(wVelx.^2 + wVely.^2); </span><br/>               <span style="color: #A0A0A0"> 229</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 230</span> <span style="color: #228B22; background: #FFFFFF;">            % Display the velocity data</span><br/>               <span style="color: #A0A0A0"> 231</span> <span style="color: #228B22; background: #FFFFFF;">            % show the velocity magnitude with length of the track relative</span><br/>               <span style="color: #A0A0A0"> 232</span> <span style="color: #228B22; background: #FFFFFF;">            % to the bottom as you would see it in Winriver II (note the</span><br/>               <span style="color: #A0A0A0"> 233</span> <span style="color: #228B22; background: #FFFFFF;">            % colorbars are difference)</span><br/>               <span style="color: #A0A0A0"> 234</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 235</span> <span style="color: #000000; background: #FFFFFF;">            if show == 1 </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 236</span> <span style="color: #000000; background: #FFFFFF;">                figure </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 237</span> <span style="color: #000000; background: #FFFFFF;">                <a href="file121.html">hold</a> on </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 238</span> <span style="color: #000000; background: #FFFFFF;">                <a href="file78.html">subplot</a> 211 </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 239</span> <span style="color: #000000; background: #FFFFFF;">                hp = <a href="file122.html">pcolor</a>(length_refBT, cellDepth, vel2); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 240</span> <span style="color: #000000; background: #FFFFFF;">                <a href="file121.html">hold</a> on </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 241</span> <span style="color: #000000; background: #FFFFFF;">                set(gca, 'ydir', 'rev') </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 242</span> <span style="color: #000000; background: #FFFFFF;">                set(hp,'edgecolor','none') </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 243</span> <span style="color: #000000; background: #FFFFFF;">                <a href="file43.html">shading</a> flat </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 244</span> <span style="color: #000000; background: #FFFFFF;">                plot(length_refBT, useData.depthEns, 'k-.', 'linewidth', 1.5) </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 245</span> <span style="color: #000000; background: #FFFFFF;">                <a href="file123.html">xlabel</a>(['Length (Ref: ', navRef, ') [m]'], 'fontsize', 16) </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 246</span> <span style="color: #000000; background: #FFFFFF;">                <a href="file124.html">ylabel</a>('Depth [m]', 'fontsize', 16) </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 247</span> <span style="color: #000000; background: #FFFFFF;">                set(gca, 'box', 'on') </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 248</span> <span style="color: #000000; background: #FFFFFF;">                <a href="file125.html">title</a>('Velocity magnitude [m/s]') </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 249</span> <span style="color: #000000; background: #FFFFFF;">                <a href="file224.html">colorbar</a> </span><br/>               <span style="color: #A0A0A0"> 250</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 251</span> <span style="color: #000000; background: #FFFFFF;">                <a href="file78.html">subplot</a> 212 </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 252</span> <span style="color: #000000; background: #FFFFFF;">                hp = <a href="file122.html">pcolor</a>(length_refBT, cellDepth, xprod); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 253</span> <span style="color: #000000; background: #FFFFFF;">                <a href="file121.html">hold</a> on </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 254</span> <span style="color: #000000; background: #FFFFFF;">                set(gca, 'ydir', 'rev') </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 255</span> <span style="color: #000000; background: #FFFFFF;">                set(hp,'edgecolor','none') </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 256</span> <span style="color: #000000; background: #FFFFFF;">                <a href="file43.html">shading</a> flat </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 257</span> <span style="color: #000000; background: #FFFFFF;">                plot(length_refBT, useData.depthEns, 'k-.', 'linewidth', 1.5) </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 258</span> <span style="color: #000000; background: #FFFFFF;">                <a href="file123.html">xlabel</a>(['Length (Ref: ', navRef, ') [m]'], 'fontsize', 16) </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 259</span> <span style="color: #000000; background: #FFFFFF;">                <a href="file124.html">ylabel</a>('Depth [m]', 'fontsize', 16) </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 260</span> <span style="color: #000000; background: #FFFFFF;">                set(gca, 'box', 'on') </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 261</span> <span style="color: #000000; background: #FFFFFF;">                <a href="file125.html">title</a>('Cross product') </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 262</span> <span style="color: #000000; background: #FFFFFF;">                <a href="file224.html">colorbar</a> </span><br/>               <span style="color: #A0A0A0"> 263</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 264</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/>               <span style="color: #A0A0A0"> 265</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 266</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 267</span> <span style="color: #228B22; background: #FFFFFF;">            %%</span><br/>               <span style="color: #A0A0A0"> 268</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 269</span> <span style="color: #228B22; background: #FFFFFF;">            %===========================</span><br/>               <span style="color: #A0A0A0"> 270</span> <span style="color: #228B22; background: #FFFFFF;">            % Compute the measured or middle portion of the discharge using</span><br/>               <span style="color: #A0A0A0"> 271</span> <span style="color: #228B22; background: #FFFFFF;">            % the delta time increase to account for invalid ensembles and</span><br/>               <span style="color: #A0A0A0"> 272</span> <span style="color: #228B22; background: #FFFFFF;">            % the WinRiver II approach to computing discharge for invalid</span><br/>               <span style="color: #A0A0A0"> 273</span> <span style="color: #228B22; background: #FFFFFF;">            % cells.</span><br/>               <span style="color: #A0A0A0"> 274</span> <span style="color: #228B22; background: #FFFFFF;">            % -------------------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 275</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 276</span> <span style="color: #228B22; background: #FFFFFF;">           </span><br/>               <span style="color: #A0A0A0"> 277</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 278</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.72 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 279</span> <span style="color: #000000; background: #FFFFFF;">            qMidCells=xprod.*cellSize.*<a href="file112.html">repmat</a>(ensDeltaTimeadj,size(wVely,1),1); </span><br/><span style="color: #FF0000">  1.10 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 280</span> <span style="color: #000000; background: #FFFFFF;">            obj.qMid=<a href="file118.html">nansum</a>(<a href="file118.html">nansum</a>(qMidCells)); </span><br/>               <span style="color: #A0A0A0"> 281</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 282</span> <span style="color: #228B22; background: #FFFFFF;">            %========================</span><br/>               <span style="color: #A0A0A0"> 283</span> <span style="color: #228B22; background: #FFFFFF;">            % IF YOU HAVE MULTIPLE TRANSECTS</span><br/>               <span style="color: #A0A0A0"> 284</span> <span style="color: #228B22; background: #FFFFFF;">            % obj(n).qMid=nansum(nansum(qMidCells));</span><br/>               <span style="color: #A0A0A0"> 285</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 286</span> <span style="color: #228B22; background: #FFFFFF;">            % Compute the discharge for invalid cells</span><br/>               <span style="color: #A0A0A0"> 287</span> <span style="color: #228B22; background: #FFFFFF;">            % ---------------------------------------</span><br/>               <span style="color: #A0A0A0"> 288</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000"> 29.24 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 289</span> <a name="Line289"></a><span style="color: #000000; background: #FF8080;">            qIntCellsCells=obj.dischargeIntcells(botMethod,exponent,xprod,z,cellSize,depthEns,cellDepth,lgclIntQCells,ensDeltaTimeadj); </span><br/><span style="color: #FF0000">  0.92 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 290</span> <span style="color: #000000; background: #FFFFFF;">            obj.qIntCells=<a href="file118.html">nansum</a>(<a href="file118.html">nansum</a>(qIntCellsCells)); </span><br/>               <span style="color: #A0A0A0"> 291</span> <span style="color: #228B22; background: #FFFFFF;">            %</span><br/>               <span style="color: #A0A0A0"> 292</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 293</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 294</span> <span style="color: #228B22; background: #FFFFFF;">            % Update middle discharge</span><br/>               <span style="color: #A0A0A0"> 295</span> <span style="color: #228B22; background: #FFFFFF;">            % -----------------------</span><br/><span style="color: #FF0000">  0.14 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 296</span> <span style="color: #000000; background: #FFFFFF;">            obj.qMid=obj.qMid+obj.qIntCells; </span><br/>               <span style="color: #A0A0A0"> 297</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 298</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 299</span> <span style="color: #228B22; background: #FFFFFF;">            % Compute the top discharge</span><br/>               <span style="color: #A0A0A0"> 300</span> <span style="color: #228B22; background: #FFFFFF;">            % -------------------------</span><br/><span style="color: #FF0000">  2.75 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 301</span> <span style="color: #000000; background: #FFFFFF;">            qTopEns=obj.dischargeTop(topRng,idxTop,idxTop3,topMethod,exponent,xprod,z,cellSize,cellDepth,depthEns,ensDeltaTimeadj); </span><br/><span style="color: #FF0000">  2.26 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 302</span> <span style="color: #000000; background: #FFFFFF;">            obj.qTop = (1 + varyQEXTPTB*<a href="file299.html">random</a>('norm', 0, useData.QextrapTBErrPct/100, 1,1))*<a href="file118.html">nansum</a>(qTopEns); </span><br/>               <span style="color: #A0A0A0"> 303</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 304</span> <span style="color: #228B22; background: #FFFFFF;">            % Compute the bottom discharge</span><br/>               <span style="color: #A0A0A0"> 305</span> <span style="color: #228B22; background: #FFFFFF;">            % ----------------------------</span><br/><span style="color: #FF0000"> 13.72 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 306</span> <a name="Line306"></a><span style="color: #000000; background: #FFC6C6;">            qBotEns=obj.dischargeBot(botRng,idxBot,botMethod,exponent,xprod,z,cellSize,depthEns,cellDepth,ensDeltaTimeadj); </span><br/>               <span style="color: #A0A0A0"> 307</span> <span style="color: #228B22; background: #FFFFFF;">      </span><br/>               <span style="color: #A0A0A0"> 308</span> <span style="color: #228B22; background: #FFFFFF;">          </span><br/><span style="color: #FF0000">  1.82 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 309</span> <span style="color: #000000; background: #FFFFFF;">            obj.qBot = (1 + varyQEXTPTB*<a href="file299.html">random</a>('norm', 0, useData.QextrapTBErrPct/100, 1,1))*<a href="file118.html">nansum</a>(qBotEns); </span><br/>               <span style="color: #A0A0A0"> 310</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 311</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 312</span> <span style="color: #228B22; background: #FFFFFF;">            % Compute right edge discharge</span><br/><span style="color: #FF0000"> 13.82 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 313</span> <a name="Line313"></a><span style="color: #000000; background: #FFC6C6;">            [obj.right] = obj.dischargeEdge(wVelx,wVely,bVelx,bVely,depthEns,ensDeltaTimeadj,startEdge,'Right',rightCoef,rightDist,rightNumEns2Avg, varyREV); </span><br/>               <span style="color: #A0A0A0"> 314</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 315</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 316</span> <span style="color: #228B22; background: #FFFFFF;">            % Compute left edge discharge</span><br/>               <span style="color: #A0A0A0"> 317</span> <span style="color: #228B22; background: #FFFFFF;">            % have added uncertainty to it</span><br/><span style="color: #FF0000"> 13.04 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 318</span> <span style="color: #000000; background: #FFC6C6;">            [obj.left] = obj.dischargeEdge(wVelx,wVely,bVelx,bVely,depthEns,ensDeltaTimeadj,startEdge,'Left',leftCoef,leftDist,leftNumEns2Avg, varyLEV); </span><br/>               <span style="color: #A0A0A0"> 319</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 320</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 321</span> <span style="color: #228B22; background: #FFFFFF;">            % Compute total discharge</span><br/>               <span style="color: #A0A0A0"> 322</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.11 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 323</span> <span style="color: #000000; background: #FFFFFF;">            obj.qTot = obj.qMid + obj.qTop + obj.qBot + obj.left + obj.right; </span><br/>               <span style="color: #A0A0A0"> 324</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 325</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 326</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 327</span> <span style="color: #228B22; background: #FFFFFF;">            % Compute discharge for valid cells and ensembles only</span><br/>               <span style="color: #A0A0A0"> 328</span> <span style="color: #228B22; background: #FFFFFF;">            % ----------------------------------------------------</span><br/><span style="color: #FF0000">  0.65 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 329</span> <span style="color: #000000; background: #FFFFFF;">            qMidNIcells=xprod.*cellSize.*<a href="file112.html">repmat</a>(ensDeltaTime,size(wVely,1),1); </span><br/><span style="color: #FF0000">  0.92 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 330</span> <span style="color: #000000; background: #FFFFFF;">            qMidNI=<a href="file118.html">nansum</a>(<a href="file118.html">nansum</a>(qMidNIcells)); </span><br/><span style="color: #FF0000">  2.64 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 331</span> <span style="color: #000000; background: #FFFFFF;">            qTopNIens=obj.dischargeTop(topRng,idxTop,idxTop3,topMethod,exponent,xprod,z,cellSize,cellDepth,depthEns,ensDeltaTime); </span><br/><span style="color: #FF0000">  0.23 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 332</span> <span style="color: #000000; background: #FFFFFF;">            qTopNI=<a href="file118.html">nansum</a>(qTopNIens); </span><br/><span style="color: #FF0000"> 13.19 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 333</span> <a name="Line333"></a><span style="color: #000000; background: #FFC6C6;">            qBotNIens=obj.dischargeBot(botRng,idxBot,botMethod,exponent,xprod,z,cellSize,depthEns,cellDepth,ensDeltaTime); </span><br/><span style="color: #FF0000">  0.27 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 334</span> <span style="color: #000000; background: #FFFFFF;">            qBotNI=<a href="file118.html">nansum</a>(qBotNIens); </span><br/>               <span style="color: #A0A0A0"> 335</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 336</span> <span style="color: #228B22; background: #FFFFFF;">            % Determine the discharge computed for invalid ensembles</span><br/>               <span style="color: #A0A0A0"> 337</span> <span style="color: #228B22; background: #FFFFFF;">            % ------------------------------------------------------</span><br/><span style="color: #FF0000">  0.23 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 338</span> <span style="color: #000000; background: #FFFFFF;">            obj.qIntEns=obj.qMid + obj.qTop + obj.qBot - qMidNI - qTopNI - qBotNI; </span><br/>               <span style="color: #A0A0A0"> 339</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 340</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.21 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 341</span> <span style="color: #000000; background: #FFFFFF;">            if isempty(varargin) % if you're running it without distributions to get the reference discharge as winriver would calculate it </span><br/>               <span style="color: #A0A0A0"> 342</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>               <span style="color: #A0A0A0"> 343</span> <span style="color: #228B22; background: #FFFFFF;">                % Compute the discharge for invalid cells if you use the valid</span><br/>               <span style="color: #A0A0A0"> 344</span> <span style="color: #228B22; background: #FFFFFF;">                % ensemble before the missing ensembles instead of the ones</span><br/>               <span style="color: #A0A0A0"> 345</span> <span style="color: #228B22; background: #FFFFFF;">                % after</span><br/>               <span style="color: #A0A0A0"> 346</span> <span style="color: #228B22; background: #FFFFFF;">                % - Simply flip things around in the adjusted time interval matric</span><br/>               <span style="color: #A0A0A0"> 347</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 348</span> <span style="color: #000000; background: #FFFFFF;">                ensDeltaTimeadj2 = ensDeltaTimeadj; </span><br/>               <span style="color: #A0A0A0"> 349</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 350</span> <span style="color: #000000; background: #FFFFFF;">                tstep = <a href="file287.html">nanmean</a>(ensDeltaTime); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 351</span> <span style="color: #000000; background: #FFFFFF;">                ffactor = round(ensDeltaTimeadj./tstep); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 352</span> <span style="color: #000000; background: #FFFFFF;">                [indUse] = find(ffactor&gt;1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 353</span> <span style="color: #000000; background: #FFFFFF;">                nEnsInt = ffactor(indUse)-1; </span><br/>               <span style="color: #A0A0A0"> 354</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 355</span> <span style="color: #000000; background: #FFFFFF;">                for ii = 1:length(indUse) </span><br/>       <span style="color: #0000FF">      8 </span><span style="color: #000000; font-weight: bold"> 356</span> <span style="color: #000000; background: #FFFFFF;">                    ensDeltaTimeadj2(indUse(ii) - nEnsInt(ii)-1:indUse(ii)) = <a href="file107.html">fliplr</a>(ensDeltaTimeadj2(indUse(ii) - nEnsInt(ii)-1:indUse(ii))); </span><br/>       <span style="color: #0000FF">      8 </span><span style="color: #000000; font-weight: bold"> 357</span> <span style="color: #000000; background: #FFFFFF;">                end </span><br/>               <span style="color: #A0A0A0"> 358</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 359</span> <span style="color: #000000; background: #FFFFFF;">                qIntCellsCells2=obj.dischargeIntcells(botMethod,exponent,xprod,z,cellSize,depthEns,cellDepth,lgclIntQCells,ensDeltaTimeadj2); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 360</span> <span style="color: #000000; background: #FFFFFF;">                qIntCells2=<a href="file118.html">nansum</a>(<a href="file118.html">nansum</a>(qIntCellsCells2)); </span><br/>               <span style="color: #A0A0A0"> 361</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 362</span> <span style="color: #000000; background: #FFFFFF;">                qMidCells2 = xprod.*cellSize.*<a href="file112.html">repmat</a>(ensDeltaTimeadj2,size(wVely,1),1); </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 363</span> <span style="color: #000000; background: #FFFFFF;">                qMid2 = <a href="file118.html">nansum</a>(<a href="file118.html">nansum</a>(qMidCells2)); </span><br/>               <span style="color: #A0A0A0"> 364</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 365</span> <span style="color: #000000; background: #FFFFFF;">                qTop2 = <a href="file118.html">nansum</a>(obj.dischargeTop(topRng,idxTop,idxTop3,topMethod,exponent,xprod,z,cellSize,cellDepth,depthEns,ensDeltaTimeadj2)); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 366</span> <span style="color: #000000; background: #FFFFFF;">                qBot2 = <a href="file118.html">nansum</a>(obj.dischargeBot(botRng,idxBot,botMethod,exponent,xprod,z,cellSize,depthEns,cellDepth,ensDeltaTimeadj2)); </span><br/>               <span style="color: #A0A0A0"> 367</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/>       <span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 368</span> <span style="color: #000000; background: #FFFFFF;">                obj.qIntEns2 = qMid2 + qIntCells2 + qTop2 + qBot2 - qMidNI - qTopNI - qBotNI; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">      1 </span><span style="color: #000000; font-weight: bold"> 369</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/>               <span style="color: #A0A0A0"> 370</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 371</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 372</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  1.20 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 373</span> <span style="color: #000000; background: #FFFFFF;">            obj.qTot = obj.qTot + varyQINTENS*obj.qIntEns*<a href="file299.html">random</a>('norm', 0, forQintUncert,1,1); </span><br/>               <span style="color: #A0A0A0"> 374</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 375</span> <span style="color: #228B22; background: #FFFFFF;">          </span><br/>               <span style="color: #A0A0A0"> 376</span> <span style="color: #228B22; background: #FFFFFF;">            % forQintUncert is the uncertainty as a fraction of qIntEns, </span><br/>               <span style="color: #A0A0A0"> 377</span> <span style="color: #228B22; background: #FFFFFF;">            % it is calculated as  (Qnodist_reBot.qIntEns -  Qnodist_reBot.qIntEns2)/ Qnodist_reBot.qIntEns</span><br/>               <span style="color: #A0A0A0"> 378</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 379</span> <span style="color: #228B22; background: #FFFFFF;">            % Assign variables to object properties</span><br/>               <span style="color: #A0A0A0"> 380</span> <span style="color: #228B22; background: #FFFFFF;">            % -------------------------------------</span><br/><span style="color: #FF0000">  0.32 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 381</span> <span style="color: #000000; background: #FFFFFF;">            obj.filename=useData.filename; </span><br/>               <span style="color: #A0A0A0"> 382</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.37 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 383</span> <span style="color: #000000; background: #FFFFFF;">            obj.qMeas=qMidNI; </span><br/>               <span style="color: #A0A0A0"> 384</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">  17001 </span><span style="color: #000000; font-weight: bold"> 385</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>