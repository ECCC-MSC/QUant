<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252" /><link rel="stylesheet" href="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /><title>Function details for MC_Data>MC_Data.MC_Data</title><link rel="stylesheet" href="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\matlab-report-styles.css" type="text/css" /></head><body bgcolor="#F8F8F8"><strong>This is a static copy of a profile report</strong><p><a href="file0.html">Home</a><p><span style="font-size:14pt; background:#FFE4B0">MC_Data>MC_Data.MC_Data (17000 calls, 454.883 sec)</span><br/><i>Generated 24-Mar-2015 14:22:43 using cpu time.</i><br/>subfunction in file D:\REPOS\QUant\MC_Data.m<br/>Copy to new window for comparing multiple runs<div class="grayline"/><div class="grayline"/><strong>Parents</strong> (calling functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td></tr><tr><td class="td-linebottomrt"><a href="file7.html">simulate_uncertainty</a></td><td class="td-linebottomrt">script</td><td class="td-linebottomrt">17000</td></tr></table><div class="grayline"/><strong>Lines where the most time was spent</strong><br/> <p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line Number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Code</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="#Line320">320</a></td><td class="td-linebottomrt"><pre>vel_temp=squeeze(Wt.vel_mps(:,...</pre></td><td class="td-linebottomrt">2618000</td><td class="td-linebottomrt">90.579 s</td><td class="td-linebottomrt" class="td-linebottomrt">19.9%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=20 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line367">367</a></td><td class="td-linebottomrt"><pre>cellSizeAll(1:end,ii)=repmat(r...</pre></td><td class="td-linebottomrt">2618000</td><td class="td-linebottomrt">65.434 s</td><td class="td-linebottomrt" class="td-linebottomrt">14.4%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=14 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line387">387</a></td><td class="td-linebottomrt"><pre>obj.idxInvalidCells=[obj.idxIn...</pre></td><td class="td-linebottomrt">2431000</td><td class="td-linebottomrt">35.686 s</td><td class="td-linebottomrt" class="td-linebottomrt">7.8%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=8 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line259">259</a></td><td class="td-linebottomrt"><pre>Wt.vel_mps = Wt.vel_mps + vary...</pre></td><td class="td-linebottomrt">17000</td><td class="td-linebottomrt">34.976 s</td><td class="td-linebottomrt" class="td-linebottomrt">7.7%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=8 height=10></td></tr><tr><td class="td-linebottomrt"><a href="#Line327">327</a></td><td class="td-linebottomrt"><pre>obj.wtVel(:,ii,:)=vel_earth_te...</pre></td><td class="td-linebottomrt">2618000</td><td class="td-linebottomrt">29.189 s</td><td class="td-linebottomrt" class="td-linebottomrt">6.4%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=6 height=10></td></tr><tr><td class="td-linebottomrt">All other lines</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">199.019 s</td><td class="td-linebottomrt">43.8%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=44 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">454.883 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><b>Children</b> (called functions)<br/><p><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Name</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Function Type</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Calls</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Total Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">% Time</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Time Plot</td></tr><tr><td class="td-linebottomrt"><a href="file116.html">squeeze</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2618000</td><td class="td-linebottomrt">73.360 s</td><td class="td-linebottomrt">16.1%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=16 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file112.html">repmat</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">2754000</td><td class="td-linebottomrt">57.862 s</td><td class="td-linebottomrt">12.7%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=13 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file299.html">random</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">204000</td><td class="td-linebottomrt">24.278 s</td><td class="td-linebottomrt">5.3%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=5 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file114.html">nanmax</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">34000</td><td class="td-linebottomrt">0.710 s</td><td class="td-linebottomrt">0.2%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt"><a href="file115.html">nanmin</a></td><td class="td-linebottomrt">function</td><td class="td-linebottomrt">17000</td><td class="td-linebottomrt">0.374 s</td><td class="td-linebottomrt">0.1%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=0 height=10></td></tr><tr><td class="td-linebottomrt">Self time (built-ins, overhead, etc.)</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">&nbsp;</td><td class="td-linebottomrt">298.299 s</td><td class="td-linebottomrt">65.6%</td><td class="td-linebottomrt"><img src="file:///C:\Program Files (x86)\MATLAB\R2012a\toolbox\matlab\codetools\private\one-pixel.gif" width=66 height=10></td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Totals</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td><td class="td-linebottomrt" bgcolor="#F0F0F0">454.883 s</td><td class="td-linebottomrt" bgcolor="#F0F0F0">100%</td><td class="td-linebottomrt" bgcolor="#F0F0F0">&nbsp;</td></tr></table><div class="grayline"/><strong>Code Analyzer results</strong><br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Line number</td><td class="td-linebottomrt" bgcolor="#F0F0F0">Message</td></tr><tr><td class="td-linebottomrt"><a href="#Line138">138</a></td><td class="td-linebottomrt"><span class="mono">To improve performance, use logical indexing instead of FIND.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line140">140</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'surfCellSize' might be unused.</span></td></tr><tr><td class="td-linebottomrt"><a href="#Line141">141</a></td><td class="td-linebottomrt"><span class="mono">The value assigned to variable 'surfCell1Dist' might be unused.</span></td></tr></table><div class="grayline"/><strong>Coverage results</strong><br/>Show coverage for parent directory <br/><table border=0 cellspacing=0 cellpadding=6><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Total lines in function</td><td class="td-linebottomrt">318</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Non-code lines (comments, blank lines)</td><td class="td-linebottomrt">169</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines (lines that can run)</td><td class="td-linebottomrt">149</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did run</td><td class="td-linebottomrt">147</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Code lines that did not run</td><td class="td-linebottomrt">2</td></tr><tr><td class="td-linebottomrt" bgcolor="#F0F0F0">Coverage (did run/can run)</td><td class="td-linebottomrt">98.66 %</td></tr></table><div class="grayline"/><b>Function listing</b><br/><pre> <span style="color: #FF0000; font-weight: bold; text-decoration: none">  time</span> <span style="color: #0000FF; font-weight: bold; text-decoration: none">  calls</span>  <span style="font-weight: bold; text-decoration: none">line</span><br/><span style="color: #FF0000">  0.13 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  84</span> <span style="color: #000000; background: #FFFFFF;">        function obj=MC_Data(filename, dataIn, varyT, varyS, varyD, varyH, varyMG, varyRD, varyLD, varyREC, varyLEC, varyWV, varyBV, varyBD) </span><br/>               <span style="color: #A0A0A0">  85</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.32 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  86</span> <span style="color: #000000; background: #FFFFFF;">            obj.topMethod = dataIn.topMethod; </span><br/><span style="color: #FF0000">  0.18 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  87</span> <span style="color: #000000; background: #FFFFFF;">            obj.botMethod = dataIn.botMethod; </span><br/><span style="color: #FF0000">  0.43 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  88</span> <span style="color: #000000; background: #FFFFFF;">            obj.exponent = dataIn.exponent; </span><br/>               <span style="color: #A0A0A0">  89</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  90</span> <span style="color: #000000; background: #FFFFFF;">            oldDraft = dataIn.ddraft.mean; % the original draft before addition of error, important, do not delete </span><br/><span style="color: #FF0000">  0.29 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  91</span> <span style="color: #000000; background: #FFFFFF;">            obj.draft =  dataIn.ddraft.mean; % initialize, you'll add variation </span><br/><span style="color: #FF0000">  0.20 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  92</span> <span style="color: #000000; background: #FFFFFF;">            obj.numEns = dataIn.numEns; </span><br/><span style="color: #FF0000">  0.08 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  93</span> <span style="color: #000000; background: #FFFFFF;">            oldCellDepth = dataIn.cellDepth; </span><br/><span style="color: #FF0000">  0.17 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  94</span> <span style="color: #000000; background: #FFFFFF;">            obj.depthEns = dataIn.depthEns; </span><br/><span style="color: #FF0000">  0.16 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  95</span> <span style="color: #000000; background: #FFFFFF;">            obj.beamDepths = dataIn.beamDepths; </span><br/><span style="color: #FF0000">  0.16 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  96</span> <span style="color: #000000; background: #FFFFFF;">            obj.ensDeltaTime = dataIn.ensDeltaTime; </span><br/>               <span style="color: #A0A0A0">  97</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.90 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  98</span> <span style="color: #000000; background: #FFFFFF;">            obj.startBank = dataIn.startBank; </span><br/><span style="color: #FF0000">  0.08 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold">  99</span> <span style="color: #000000; background: #FFFFFF;">            obj.lDist = dataIn.llDist.mean; </span><br/><span style="color: #FF0000">  0.07 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 100</span> <span style="color: #000000; background: #FFFFFF;">            obj.rDist = dataIn.rrDist.mean; </span><br/>               <span style="color: #A0A0A0"> 101</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.08 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 102</span> <span style="color: #000000; background: #FFFFFF;">            obj.leftCoef = dataIn.lleftCoef.mean; % as of Feb 18 I add error to these values </span><br/><span style="color: #FF0000">  0.07 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 103</span> <span style="color: #000000; background: #FFFFFF;">            obj.rightCoef = dataIn.rrightCoef.mean; </span><br/>               <span style="color: #A0A0A0"> 104</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.75 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 105</span> <span style="color: #000000; background: #FFFFFF;">            obj.heading = dataIn.hheading.mean; </span><br/>               <span style="color: #A0A0A0"> 106</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 107</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.20 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 108</span> <span style="color: #000000; background: #FFFFFF;">            obj.leftNumEns2Avg  = dataIn.leftNumEns2Avg; </span><br/><span style="color: #FF0000">  0.26 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 109</span> <span style="color: #000000; background: #FFFFFF;">            obj.rightNumEns2Avg = dataIn.rightNumEns2Avg; </span><br/>               <span style="color: #A0A0A0"> 110</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.03 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 111</span> <span style="color: #000000; background: #FFFFFF;">            beamAngle = dataIn.beamAngle; </span><br/>               <span style="color: #A0A0A0"> 112</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.18 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 113</span> <span style="color: #000000; background: #FFFFFF;">            obj.btVel_reGGA = dataIn.btVel_reGGA; </span><br/><span style="color: #FF0000">  0.14 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 114</span> <span style="color: #000000; background: #FFFFFF;">            obj.btVel_reVTG = dataIn.btVel_reVTG; </span><br/>               <span style="color: #A0A0A0"> 115</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 116</span> <span style="color: #000000; background: #FFFFFF;">            Cfg = dataIn.Cfg; </span><br/><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 117</span> <span style="color: #000000; background: #FFFFFF;">            Bt = dataIn.Bt; </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 118</span> <span style="color: #000000; background: #FFFFFF;">            Wt = dataIn.Wt; </span><br/><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 119</span> <span style="color: #000000; background: #FFFFFF;">            Sensor = dataIn.Sensor; </span><br/>               <span style="color: #A0A0A0"> 120</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.56 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 121</span> <span style="color: #000000; background: #FFFFFF;">            obj.QextrapTBErrPct = dataIn.QextrapTBErrPct; </span><br/>               <span style="color: #A0A0A0"> 122</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 123</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 124</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.12 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 125</span> <span style="color: #000000; background: #FFFFFF;">            lag = Cfg.lag_cm'./100; </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 126</span> <span style="color: #000000; background: #FFFFFF;">            pulseLen = Cfg.xmitPulse_cm'./100; </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 127</span> <span style="color: #000000; background: #FFFFFF;">            regCellSize = Cfg.ws_cm'./100; </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 128</span> <span style="color: #000000; background: #FFFFFF;">            regCellSize(regCellSize==0)=nan; </span><br/><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 129</span> <span style="color: #000000; background: #FFFFFF;">            cell1Dist = Cfg.distBin1_cm'./100; </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 130</span> <span style="color: #000000; background: #FFFFFF;">            numRegCells=size(Wt.vel_mps,1); </span><br/><span style="color: #FF0000">  0.12 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 131</span> <span style="color: #000000; background: #FFFFFF;">            obj.maxCells=numRegCells; </span><br/>               <span style="color: #A0A0A0"> 132</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 133</span> <span style="color: #228B22; background: #FFFFFF;">         </span><br/>               <span style="color: #A0A0A0"> 134</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 135</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.16 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 136</span> <span style="color: #000000; background: #FFFFFF;">            surfCells_idx=find(isnan(dataIn.Surface.no_cells)); </span><br/><span style="color: #FF0000">  0.08 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 137</span> <span style="color: #000000; background: #FFFFFF;">            noSurfCells=dataIn.Surface.no_cells'; </span><br/><a name="Line138"></a><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 138</span> <span style="color: #000000; background: #FFFFFF;">            noSurfCells(surfCells_idx)=0; </span><br/><span style="color: #FF0000">  0.51 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 139</span> <span style="color: #000000; background: #FFFFFF;">            maxSurfCells=<a href="file114.html">nanmax</a>(noSurfCells); </span><br/><a name="Line140"></a><span style="color: #FF0000">  0.16 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 140</span> <span style="color: #000000; background: #FFFFFF;">            surfCellSize=dataIn.Surface.cell_size_cm'./100; </span><br/><a name="Line141"></a><span style="color: #FF0000">  0.12 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 141</span> <span style="color: #000000; background: #FFFFFF;">            surfCell1Dist=dataIn.Surface.dist_bin1_cm'./100; </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 142</span> <span style="color: #000000; background: #FFFFFF;">            numRegCells=size(Wt.vel_mps,1); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 143</span> <span style="color: #000000; background: #FFFFFF;">            obj.maxCells=maxSurfCells+numRegCells; </span><br/>               <span style="color: #A0A0A0"> 144</span> <span style="color: #228B22; background: #FFFFFF;">            %</span><br/>               <span style="color: #A0A0A0"> 145</span> <span style="color: #228B22; background: #FFFFFF;">            % Beam angle is used to ID RiverRay data with variable modes and</span><br/>               <span style="color: #A0A0A0"> 146</span> <span style="color: #228B22; background: #FFFFFF;">            % lags</span><br/>               <span style="color: #A0A0A0"> 147</span> <span style="color: #228B22; background: #FFFFFF;">            % --------------------------------------------------------------</span><br/>               <span style="color: #A0A0A0"> 148</span> <span style="color: #228B22; background: #FFFFFF;">            %if Inst.beamAng(1)&lt;21</span><br/>               <span style="color: #A0A0A0"> 149</span> <span style="color: #228B22; background: #FFFFFF;">            %</span><br/>               <span style="color: #A0A0A0"> 150</span> <span style="color: #228B22; background: #FFFFFF;">            % Compute side lobe interference limit</span><br/>               <span style="color: #A0A0A0"> 151</span> <span style="color: #228B22; background: #FFFFFF;">            % ------------------------------------</span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 152</span> <span style="color: #000000; background: #FFFFFF;">            lagEffect_m=(lag+pulseLen+regCellSize)./2; </span><br/><span style="color: #FF0000">  0.74 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 153</span> <span style="color: #000000; background: #FFFFFF;">            depthmin=<a href="file115.html">nanmin</a>(obj.beamDepths); </span><br/><span style="color: #FF0000">  1.52 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 154</span> <span style="color: #000000; background: #FFFFFF;">            lastcell=depthmin.*cosd(beamAngle)-(lagEffect_m); </span><br/>               <span style="color: #A0A0A0"> 155</span> <span style="color: #228B22; background: #FFFFFF;">          </span><br/><span style="color: #FF0000">  0.53 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 156</span> <span style="color: #000000; background: #FFFFFF;">            obj.numCells=max([floor(((lastcell-cell1Dist)./regCellSize)+1); zeros(size(lastcell))],[],1); </span><br/><span style="color: #FF0000">  0.23 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 157</span> <span style="color: #000000; background: #FFFFFF;">            obj.numCells(obj.numCells&gt;numRegCells)=numRegCells; </span><br/><span style="color: #FF0000">  0.37 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 158</span> <span style="color: #000000; background: #FFFFFF;">            if <a href="file114.html">nanmax</a>(noSurfCells)&gt;0 </span><br/>               <span style="color: #A0A0A0"> 159</span> <span style="color: #A0A0A0; background: #FFFFFF;">                obj.numCells=obj.numCells+noSurfCells;</span><br/>               <span style="color: #A0A0A0"> 160</span> <span style="color: #A0A0A0; background: #FFFFFF;">            end</span><br/>               <span style="color: #A0A0A0"> 161</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 162</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 163</span> <span style="color: #228B22; background: #FFFFFF;">            %++++++++++++++++</span><br/>               <span style="color: #A0A0A0"> 164</span> <span style="color: #228B22; background: #FFFFFF;">            % now modify the parameters</span><br/>               <span style="color: #A0A0A0"> 165</span> <span style="color: #228B22; background: #FFFFFF;">            % take a random sample for each ensemble</span><br/>               <span style="color: #A0A0A0"> 166</span> <span style="color: #228B22; background: #FFFFFF;">            %++++++++++++++++</span><br/>               <span style="color: #A0A0A0"> 167</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  1.43 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 168</span> <span style="color: #000000; background: #FFFFFF;">            obj.draft = dataIn.ddraft.mean + varyD*<a href="file299.html">random</a>('norm', dataIn.ddraft.meanErr, dataIn.ddraft.stdErr,1, obj.numEns); </span><br/>               <span style="color: #A0A0A0"> 169</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 170</span> <span style="color: #228B22; background: #FFFFFF;">            % if error is independent of heading</span><br/><span style="color: #FF0000">  2.50 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 171</span> <span style="color: #000000; background: #FFFFFF;">            obj.heading = dataIn.hheading.mean + varyH*<a href="file299.html">random</a>('norm', dataIn.hheading.meanErr, dataIn.hheading.stdErr,1, obj.numEns) + varyMG*<a href="file299.html">random</a>('norm', dataIn.mmagDec.meanErr, dataIn.mmagDec.stdErr,1, obj.numEns); </span><br/>               <span style="color: #A0A0A0"> 172</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 173</span> <span style="color: #228B22; background: #FFFFFF;">            %%%%%%%%%%%%%%%%%%%%</span><br/>               <span style="color: #A0A0A0"> 174</span> <span style="color: #228B22; background: #FFFFFF;">            % SAM April 10 2014</span><br/>               <span style="color: #A0A0A0"> 175</span> <span style="color: #228B22; background: #FFFFFF;">            % the uncertainty on the compass heading changes with heading</span><br/>               <span style="color: #A0A0A0"> 176</span> <span style="color: #228B22; background: #FFFFFF;">            % (recall Marsden proceedings form Utah)</span><br/>               <span style="color: #A0A0A0"> 177</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 178</span> <span style="color: #228B22; background: #FFFFFF;">            % Personal communication from R. Marsden sent April 14, 2014:</span><br/>               <span style="color: #A0A0A0"> 179</span> <span style="color: #228B22; background: #FFFFFF;">            %%%%%%%%%%%%%%%%%</span><br/>               <span style="color: #A0A0A0"> 180</span> <span style="color: #228B22; background: #FFFFFF;">            %             The heading output by a magnetic compass can be described by</span><br/>               <span style="color: #A0A0A0"> 181</span> <span style="color: #228B22; background: #FFFFFF;">            %  </span><br/>               <span style="color: #A0A0A0"> 182</span> <span style="color: #228B22; background: #FFFFFF;">            % Houtput = Htrue + A1*cos(Htrue + delta1) + A2*cos(2*Htrue +delta2)</span><br/>               <span style="color: #A0A0A0"> 183</span> <span style="color: #228B22; background: #FFFFFF;">            %  </span><br/>               <span style="color: #A0A0A0"> 184</span> <span style="color: #228B22; background: #FFFFFF;">            % where </span><br/>               <span style="color: #A0A0A0"> 185</span> <span style="color: #228B22; background: #FFFFFF;">            %  </span><br/>               <span style="color: #A0A0A0"> 186</span> <span style="color: #228B22; background: #FFFFFF;">            % Htrue is the actual heading the would be reported if there were no errors, </span><br/>               <span style="color: #A0A0A0"> 187</span> <span style="color: #228B22; background: #FFFFFF;">            %  </span><br/>               <span style="color: #A0A0A0"> 188</span> <span style="color: #228B22; background: #FFFFFF;">            % A1 and A2 are the magnitude of the 'one cycle' and 'two cycle' errors in degrees</span><br/>               <span style="color: #A0A0A0"> 189</span> <span style="color: #228B22; background: #FFFFFF;">            %  </span><br/>               <span style="color: #A0A0A0"> 190</span> <span style="color: #228B22; background: #FFFFFF;">            % delta1 and delta2 are the phases of the two error types. </span><br/>               <span style="color: #A0A0A0"> 191</span> <span style="color: #228B22; background: #FFFFFF;">            %  </span><br/>               <span style="color: #A0A0A0"> 192</span> <span style="color: #228B22; background: #FFFFFF;">            % For a well calibrated compass, A1 and A2 are on the order of 1 degree or less and the overall compass error is 1degree RMS or less.</span><br/>               <span style="color: #A0A0A0"> 193</span> <span style="color: #228B22; background: #FFFFFF;">            % compass calibration should remove the one cycle and two cycle</span><br/>               <span style="color: #A0A0A0"> 194</span> <span style="color: #228B22; background: #FFFFFF;">            % errors</span><br/>               <span style="color: #A0A0A0"> 195</span> <span style="color: #228B22; background: #FFFFFF;">            % but some error remains (see figure3 of Marsden - HMEM2012-000235).</span><br/>               <span style="color: #A0A0A0"> 196</span> <span style="color: #228B22; background: #FFFFFF;">            % assume that A1 = A2 = .25</span><br/>               <span style="color: #A0A0A0"> 197</span> <span style="color: #228B22; background: #FFFFFF;">            % assume that delta 1 = -15 deg and delta 2 = -25 deg (phase of</span><br/>               <span style="color: #A0A0A0"> 198</span> <span style="color: #228B22; background: #FFFFFF;">            % one and two cycle </span><br/>               <span style="color: #A0A0A0"> 199</span> <span style="color: #228B22; background: #FFFFFF;">           </span><br/>               <span style="color: #A0A0A0"> 200</span> <span style="color: #228B22; background: #FFFFFF;">            % last used by SAMoore 15 juillet 2014</span><br/>               <span style="color: #A0A0A0"> 201</span> <span style="color: #228B22; background: #FFFFFF;">            % UNCOMMENT ME IF YOU WANT TO USE A HEADING DEPENDENT ERROR</span><br/>               <span style="color: #A0A0A0"> 202</span> <span style="color: #228B22; background: #FFFFFF;">            %obj.heading = dataIn.hheading.mean + varyH*random('norm', 1,1, 1,length(dataIn.hheading.mean)).*cosd(dataIn.hheading.mean - 15) + varyH*random('norm', 1,1, 1,length(dataIn.hheading.mean)).*cosd(2*dataIn.hheading.mean - 25) + varyMG*random('norm', dataIn.mmagDec.meanErr, dataIn.mmagDec.stdErr,1, obj.numEns);</span><br/>               <span style="color: #A0A0A0"> 203</span> <span style="color: #228B22; background: #FFFFFF;">           </span><br/>               <span style="color: #A0A0A0"> 204</span> <span style="color: #228B22; background: #FFFFFF;">   </span><br/>               <span style="color: #A0A0A0"> 205</span> <span style="color: #228B22; background: #FFFFFF;">          %  phis = linspace(0,360,100);</span><br/>               <span style="color: #A0A0A0"> 206</span> <span style="color: #228B22; background: #FFFFFF;">          %  noise =  1.*cosd(phis - 15) + 1*cosd(2*phis - 25); with a</span><br/>               <span style="color: #A0A0A0"> 207</span> <span style="color: #228B22; background: #FFFFFF;">          %  noise of 1 degree on both components</span><br/>               <span style="color: #A0A0A0"> 208</span> <span style="color: #228B22; background: #FFFFFF;">        </span><br/>               <span style="color: #A0A0A0"> 209</span> <span style="color: #228B22; background: #FFFFFF;">            %%%%%%%%%%%%%%%%%%%%%</span><br/>               <span style="color: #A0A0A0"> 210</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 211</span> <span style="color: #228B22; background: #FFFFFF;">            % recall line 127 of OriginData_sm:</span><br/>               <span style="color: #A0A0A0"> 212</span> <span style="color: #228B22; background: #FFFFFF;">            %  obj.heading=Sensor.heading_deg + obj.magDec;, therefore you</span><br/>               <span style="color: #A0A0A0"> 213</span> <span style="color: #228B22; background: #FFFFFF;">            %  must add the noise from both heading and magnetic</span><br/>               <span style="color: #A0A0A0"> 214</span> <span style="color: #228B22; background: #FFFFFF;">            %  declination</span><br/>               <span style="color: #A0A0A0"> 215</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 216</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 217</span> <span style="color: #000000; background: #FFFFFF;">            c = Sensor.sos_mps'; % this is the value of the sos used to calculate beam depth, size and all velocities </span><br/><span style="color: #FF0000">  0.17 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 218</span> <span style="color: #000000; background: #FFFFFF;">            obj.T = Sensor.temperature_degc'; </span><br/><span style="color: #FF0000">  0.20 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 219</span> <span style="color: #000000; background: #FFFFFF;">            obj.S = Sensor.salinity_ppt'; </span><br/>               <span style="color: #A0A0A0"> 220</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  1.35 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 221</span> <span style="color: #000000; background: #FFFFFF;">            obj.T = obj.T + varyT*<a href="file299.html">random</a>('norm', dataIn.ttemperature.meanErr, dataIn.ttemperature.stdErr,1,obj.numEns); </span><br/><span style="color: #FF0000">  1.35 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 222</span> <span style="color: #000000; background: #FFFFFF;">            obj.S = obj.S + varyS*<a href="file299.html">random</a>('norm', dataIn.ssalinity.meanErr, dataIn.ssalinity.stdErr,1,obj.numEns); </span><br/>               <span style="color: #A0A0A0"> 223</span> <span style="color: #228B22; background: #FFFFFF;">            % recalculate the sound speed for the new temperature and</span><br/>               <span style="color: #A0A0A0"> 224</span> <span style="color: #228B22; background: #FFFFFF;">            % salinity</span><br/><span style="color: #FF0000">  0.71 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 225</span> <span style="color: #000000; background: #FFFFFF;">            c2 = round(1449.2 + 4.6*obj.T - 0.055*obj.T.^2 + 0.00029*obj.T.^3 + (1.34 - 0.01*obj.T).*(obj.S - 35)); </span><br/>               <span style="color: #A0A0A0"> 226</span> <span style="color: #228B22; background: #FFFFFF;">            % If no uncertainty, c2 should be equivalent to Sensor.sos_mps</span><br/>               <span style="color: #A0A0A0"> 227</span> <span style="color: #228B22; background: #FFFFFF;">            % NB: Winriver rounds to the nearest one</span><br/>               <span style="color: #A0A0A0"> 228</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 229</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 230</span> <span style="color: #000000; background: #FFFFFF;">            [nbins,nens,nbeams] = size(Wt.vel_mps); </span><br/>               <span style="color: #A0A0A0"> 231</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 232</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.33 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 233</span> <span style="color: #000000; background: #FFFFFF;">            obj.depthEns = (c2./c).*(obj.depthEns - oldDraft + obj.draft); </span><br/><span style="color: #FF0000">  1.49 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 234</span> <span style="color: #000000; background: #FFFFFF;">            cell1Dist = (c2./c).*cell1Dist; </span><br/>               <span style="color: #A0A0A0"> 235</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.56 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 236</span> <span style="color: #000000; background: #FFFFFF;">            mfactor = <a href="file112.html">repmat</a>(c2./c, nbins,1); </span><br/><span style="color: #FF0000">  0.61 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 237</span> <span style="color: #000000; background: #FFFFFF;">            Wt.vel_mps(:,:,1) = mfactor.*Wt.vel_mps(:,:,1); </span><br/><span style="color: #FF0000">  0.26 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 238</span> <span style="color: #000000; background: #FFFFFF;">            Wt.vel_mps(:,:,2) = mfactor.*Wt.vel_mps(:,:,2); </span><br/><span style="color: #FF0000">  0.22 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 239</span> <span style="color: #000000; background: #FFFFFF;">            Wt.vel_mps(:,:,3) = mfactor.*Wt.vel_mps(:,:,3); </span><br/><span style="color: #FF0000">  0.23 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 240</span> <span style="color: #000000; background: #FFFFFF;">            Wt.vel_mps(:,:,4) = mfactor.*Wt.vel_mps(:,:,4); </span><br/>               <span style="color: #A0A0A0"> 241</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.15 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 242</span> <span style="color: #000000; background: #FFFFFF;">            Bt.vel_mps(1,:) =(c2./c).*Bt.vel_mps(1,:); </span><br/><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 243</span> <span style="color: #000000; background: #FFFFFF;">            Bt.vel_mps(2,:) = (c2./c).*Bt.vel_mps(2,:); </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 244</span> <span style="color: #000000; background: #FFFFFF;">            Bt.vel_mps(3,:) = (c2./c).*Bt.vel_mps(3,:); </span><br/><span style="color: #FF0000">  0.11 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 245</span> <span style="color: #000000; background: #FFFFFF;">            Bt.vel_mps(4,:) = (c2./c).*Bt.vel_mps(4,:); </span><br/>               <span style="color: #A0A0A0"> 246</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 247</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 248</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 249</span> <span style="color: #228B22; background: #FFFFFF;">            % ADD RANDOM UNCERTAINTY RESULTING FROM ACOUSTIC METHOD</span><br/>               <span style="color: #A0A0A0"> 250</span> <span style="color: #228B22; background: #FFFFFF;">            % error is given in m/s</span><br/>               <span style="color: #A0A0A0"> 251</span> <span style="color: #228B22; background: #FFFFFF;">            % add random error (in cm/s, function of number of pings) and</span><br/>               <span style="color: #A0A0A0"> 252</span> <span style="color: #228B22; background: #FFFFFF;">            % systematic error</span><br/>               <span style="color: #A0A0A0"> 253</span> <span style="color: #228B22; background: #FFFFFF;">            %%%%%%%%%%</span><br/>               <span style="color: #A0A0A0"> 254</span> <span style="color: #228B22; background: #FFFFFF;">            % the error is the root mean square of the relative errors</span><br/>               <span style="color: #A0A0A0"> 255</span> <span style="color: #228B22; background: #FFFFFF;">            % (systematic and ping dependent)</span><br/>               <span style="color: #A0A0A0"> 256</span> <span style="color: #228B22; background: #FFFFFF;">            % last modified 2014/08/08 by SAM</span><br/>               <span style="color: #A0A0A0"> 257</span> <span style="color: #228B22; background: #FFFFFF;">          </span><br/>               <span style="color: #A0A0A0"> 258</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000"> 34.98 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 259</span> <a name="Line259"></a><span style="color: #000000; background: #FFD4D4;">            Wt.vel_mps = Wt.vel_mps + varyWV*Wt.vel_mps.*<a href="file299.html">random</a>('norm', 0, sqrt((dataIn.velErr./Wt.vel_mps).^2 + (dataIn.velSysErr./Wt.vel_mps).^2), nbins, nens, nbeams) ;% last three numbers give the size      </span><br/><span style="color: #FF0000">  1.15 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 260</span> <span style="color: #000000; background: #FFFFFF;">            Bt.vel_mps = Bt.vel_mps + varyBV.*<a href="file299.html">random</a>('norm', 0, dataIn.velBtErr, nbeams, nens); </span><br/>               <span style="color: #A0A0A0"> 261</span> <span style="color: #228B22; background: #FFFFFF;"></span><br/>               <span style="color: #A0A0A0"> 262</span> <span style="color: #228B22; background: #FFFFFF;">            %Wt.vel_mps = Wt.vel_mps + varyWV*Wt.vel_mps.*random('norm', 0, sqrt((dataIn.velErr./Wt.vel_mps).^2 + (dataIn.velSysErrPct/100).^2), nbins, nens, nbeams) ;% last three numbers give the size</span><br/>               <span style="color: #A0A0A0"> 263</span> <span style="color: #228B22; background: #FFFFFF;">           % Bt.vel_mps = Bt.vel_mps + varyBV*Bt.vel_mps.*random('norm', 0, dataIn.velBtErrPct, nbeams, nens);</span><br/>               <span style="color: #A0A0A0"> 264</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 265</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 266</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 267</span> <span style="color: #228B22; background: #FFFFFF;">            % ADD RANDOM UNCERTAINTY TO THE DEPTH,(SEE P 116 OF SIMPSON 2001)</span><br/>               <span style="color: #A0A0A0"> 268</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  1.23 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 269</span> <span style="color: #000000; background: #FFFFFF;">            obj.depthEns = obj.depthEns + varyBD*obj.depthEns.*<a href="file299.html">random</a>('norm', 0, dataIn.depthErrPct/100,1,obj.numEns); </span><br/>               <span style="color: #A0A0A0"> 270</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 271</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  1.16 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 272</span> <span style="color: #000000; background: #FFFFFF;">            obj.lDist = obj.lDist + varyLD*<a href="file299.html">random</a>('norm', dataIn.llDist.meanErr, dataIn.llDist.stdErr,1); </span><br/><span style="color: #FF0000">  0.92 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 273</span> <span style="color: #000000; background: #FFFFFF;">            obj.rDist = obj.rDist + varyRD*<a href="file299.html">random</a>('norm', dataIn.rrDist.meanErr, dataIn.rrDist.stdErr,1); </span><br/>               <span style="color: #A0A0A0"> 274</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.86 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 275</span> <span style="color: #000000; background: #FFFFFF;">            obj.leftCoef = obj.leftCoef + varyLEC*<a href="file299.html">random</a>('norm', obj.leftCoef*dataIn.lleftCoef.meanErr/100, obj.leftCoef*dataIn.lleftCoef.stdErr/100,1); </span><br/><span style="color: #FF0000">  0.87 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 276</span> <span style="color: #000000; background: #FFFFFF;">            obj.rightCoef = obj.rightCoef + varyREC*<a href="file299.html">random</a>('norm', obj.rightCoef*dataIn.rrightCoef.meanErr/100, obj.rightCoef*dataIn.rrightCoef.stdErr/100,1); </span><br/>               <span style="color: #A0A0A0"> 277</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 278</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 279</span> <span style="color: #000000; background: #FFFFFF;">            for ind = 1:obj.numEns </span><br/><span style="color: #FF0000"> 18.62 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 280</span> <span style="color: #000000; background: #FFE2E2;">                obj.cellDepth(:,ind) = oldCellDepth(:,ind) - oldDraft + obj.draft(ind); </span><br/><span style="color: #FF0000">  2.19 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 281</span> <span style="color: #000000; background: #FFFFFF;">                obj.beamDepths(:,ind) = obj.beamDepths(:,ind) -oldDraft + obj.draft(ind); </span><br/><span style="color: #FF0000">  0.58 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 282</span> <span style="color: #000000; background: #FFFFFF;">                cell1Dist(ind) = cell1Dist(ind) - oldDraft + obj.draft(ind); </span><br/><span style="color: #FF0000">  0.63 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 283</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/>               <span style="color: #A0A0A0"> 284</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 285</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 286</span> <span style="color: #228B22; background: #FFFFFF;">            %</span><br/>               <span style="color: #A0A0A0"> 287</span> <span style="color: #228B22; background: #FFFFFF;">            % Create matrix with only cells above sidelobe</span><br/>               <span style="color: #A0A0A0"> 288</span> <span style="color: #228B22; background: #FFFFFF;">            % ---------------------------------------------</span><br/><span style="color: #FF0000">  0.32 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 289</span> <span style="color: #000000; background: #FFFFFF;">            obj.cellsAboveSL=ones(obj.maxCells,obj.numEns); </span><br/><span style="color: #FF0000">&lt; 0.01 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 290</span> <span style="color: #000000; background: #FFFFFF;">            for j=1:obj.numEns </span><br/><span style="color: #FF0000">  1.01 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 291</span> <span style="color: #000000; background: #FFFFFF;">                for i=obj.numCells(j)+1:obj.maxCells </span><br/><span style="color: #FF0000">  6.94 </span><span style="color: #0000FF">39780000 </span><span style="color: #000000; font-weight: bold"> 292</span> <span style="color: #000000; background: #FFFFFF;">                    obj.cellsAboveSL(i,j)=nan; </span><br/><span style="color: #FF0000">  6.79 </span><span style="color: #0000FF">39780000 </span><span style="color: #000000; font-weight: bold"> 293</span> <span style="color: #000000; background: #FFFFFF;">                end </span><br/><span style="color: #FF0000">  1.09 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 294</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/>               <span style="color: #A0A0A0"> 295</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 296</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 297</span> <span style="color: #228B22; background: #FFFFFF;">            %</span><br/>               <span style="color: #A0A0A0"> 298</span> <span style="color: #228B22; background: #FFFFFF;">            % Create variables for transformation matrix (instrument to earth)</span><br/>               <span style="color: #A0A0A0"> 299</span> <span style="color: #228B22; background: #FFFFFF;">            % ----------------------------------------------------------------</span><br/><span style="color: #FF0000">  0.46 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 300</span> <span style="color: #000000; background: #FFFFFF;">            CH=cosd(obj.heading); </span><br/><span style="color: #FF0000">  0.28 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 301</span> <span style="color: #000000; background: #FFFFFF;">            SH=sind(obj.heading); </span><br/><span style="color: #FF0000">  0.25 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 302</span> <span style="color: #000000; background: #FFFFFF;">            P=atand(tand(0).*cosd(0)); </span><br/><span style="color: #FF0000">  0.08 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 303</span> <span style="color: #000000; background: #FFFFFF;">            CP=cosd(P); </span><br/><span style="color: #FF0000">  0.07 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 304</span> <span style="color: #000000; background: #FFFFFF;">            SP=sind(P); </span><br/><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 305</span> <span style="color: #000000; background: #FFFFFF;">            CR=cosd(0); </span><br/><span style="color: #FF0000">  0.06 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 306</span> <span style="color: #000000; background: #FFFFFF;">            SR=sind(0); </span><br/>               <span style="color: #A0A0A0"> 307</span> <span style="color: #228B22; background: #FFFFFF;">            %</span><br/>               <span style="color: #A0A0A0"> 308</span> <span style="color: #228B22; background: #FFFFFF;">            % Convert ship data to earth data</span><br/>               <span style="color: #A0A0A0"> 309</span> <span style="color: #228B22; background: #FFFFFF;">            % -------------------------------</span><br/><span style="color: #FF0000">  0.62 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 310</span> <span style="color: #000000; background: #FFFFFF;">            obj.btVel=nan(4,obj.numEns); </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 311</span> <span style="color: #000000; background: #FFFFFF;">            for ii=1:obj.numEns </span><br/><span style="color: #FF0000"> 10.62 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 312</span> <span style="color: #000000; background: #FFF0F0;">                trans_ie=[((CH(ii).*CR)+(SH(ii).*SP.*SR)) (SH(ii).*CP) ((CH(ii).*SR)-(SH(ii).*SP.*CR));... </span><br/>               <span style="color: #A0A0A0"> 313</span> <span style="color: #000000; background: #FFF0F0;">                    ((-1.*SH(ii).*CR)+(CH(ii).*SP.*SR)) (CH(ii).*CP) ((-1.*SH(ii).*SR)-(CH(ii).*SP.*CR));...</span><br/>               <span style="color: #A0A0A0"> 314</span> <span style="color: #000000; background: #FFF0F0;">                    (-1.*CP.*SR) (SP) (CP.*CR)];</span><br/><span style="color: #FF0000"> 27.75 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 315</span> <span style="color: #000000; background: #FFD4D4;">                obj.btVel(1:3,ii)=trans_ie*Bt.vel_mps(1:3,ii); </span><br/><span style="color: #FF0000">  1.08 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 316</span> <span style="color: #000000; background: #FFFFFF;">                obj.btVel(4,ii)=Bt.vel_mps(4,ii); </span><br/><span style="color: #FF0000">  0.58 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 317</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/><span style="color: #FF0000">  0.94 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 318</span> <span style="color: #000000; background: #FFFFFF;">            obj.wtVel=nan(obj.maxCells,obj.numEns,4); </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 319</span> <span style="color: #000000; background: #FFFFFF;">            for ii=1:obj.numEns </span><br/><span style="color: #FF0000"> 90.58 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 320</span> <a name="Line320"></a><span style="color: #000000; background: #FF8080;">                vel_temp=<a href="file116.html">squeeze</a>(Wt.vel_mps(:,ii,:))'; </span><br/><span style="color: #FF0000">  9.96 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 321</span> <span style="color: #000000; background: #FFF0F0;">                trans_ie=[((CH(ii).*CR)+(SH(ii).*SP.*SR)) (SH(ii).*CP) ((CH(ii).*SR)-(SH(ii).*SP.*CR));... </span><br/>               <span style="color: #A0A0A0"> 322</span> <span style="color: #000000; background: #FFF0F0;">                    ((-1.*SH(ii).*CR)+(CH(ii).*SP.*SR)) (CH(ii).*CP) ((-1.*SH(ii).*SR)-(CH(ii).*SP.*CR));...</span><br/>               <span style="color: #A0A0A0"> 323</span> <span style="color: #000000; background: #FFF0F0;">                    (-1.*CP.*SR) (SP) (CP.*CR)];</span><br/>               <span style="color: #A0A0A0"> 324</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/><span style="color: #FF0000"> 13.76 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 325</span> <span style="color: #000000; background: #FFF0F0;">                vel_earth_temp=trans_ie*vel_temp(1:3,:); </span><br/><span style="color: #FF0000">  9.36 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 326</span> <span style="color: #000000; background: #FFF0F0;">                vel_earth_temp(4,:)=vel_temp(4,:); </span><br/><span style="color: #FF0000"> 29.19 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 327</span> <a name="Line327"></a><span style="color: #000000; background: #FFD4D4;">                obj.wtVel(:,ii,:)=vel_earth_temp'; </span><br/><span style="color: #FF0000">  0.69 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 328</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/>               <span style="color: #A0A0A0"> 329</span> <span style="color: #228B22; background: #FFFFFF;">       </span><br/>               <span style="color: #A0A0A0"> 330</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 331</span> <span style="color: #228B22; background: #FFFFFF;">            %</span><br/>               <span style="color: #A0A0A0"> 332</span> <span style="color: #228B22; background: #FFFFFF;">            % Convert water track velocity to water velocity</span><br/>               <span style="color: #A0A0A0"> 333</span> <span style="color: #228B22; background: #FFFFFF;">            % ----------------------------------------------</span><br/><span style="color: #FF0000">  1.27 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 334</span> <span style="color: #000000; background: #FFFFFF;">            wVel(:,:,1)=obj.wtVel(:,:,1)-<a href="file112.html">repmat</a>(obj.btVel(1,:),size(obj.wtVel,1),1); </span><br/><span style="color: #FF0000">  1.27 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 335</span> <span style="color: #000000; background: #FFFFFF;">            wVel(:,:,2)=obj.wtVel(:,:,2)-<a href="file112.html">repmat</a>(obj.btVel(2,:),size(obj.wtVel,1),1); </span><br/><span style="color: #FF0000">  1.53 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 336</span> <span style="color: #000000; background: #FFFFFF;">            wVel(:,:,3)=obj.wtVel(:,:,3)-<a href="file112.html">repmat</a>(obj.btVel(3,:),size(obj.wtVel,1),1); %added by EJ </span><br/><span style="color: #FF0000">  0.44 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 337</span> <span style="color: #000000; background: #FFFFFF;">            wVel(:,:,4)=obj.wtVel(:,:,4); %added by EJ </span><br/>               <span style="color: #A0A0A0"> 338</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  1.41 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 339</span> <span style="color: #000000; background: #FFFFFF;">            obj.wVelx(:,:)=wVel(1:obj.maxCells,:,1).*obj.cellsAboveSL; </span><br/><span style="color: #FF0000">  0.88 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 340</span> <span style="color: #000000; background: #FFFFFF;">            obj.wVely(:,:)=wVel(1:obj.maxCells,:,2).*obj.cellsAboveSL; </span><br/><span style="color: #FF0000">  0.76 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 341</span> <span style="color: #000000; background: #FFFFFF;">            obj.wVelz(:,:)=wVel(1:obj.maxCells,:,3).*obj.cellsAboveSL; </span><br/><span style="color: #FF0000">  1.00 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 342</span> <span style="color: #000000; background: #FFFFFF;">            obj.wVelerr(:,:)=wVel(1:obj.maxCells,:,4).*obj.cellsAboveSL; </span><br/>               <span style="color: #A0A0A0"> 343</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 344</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 345</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  1.12 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 346</span> <span style="color: #000000; background: #FFFFFF;">            wVel_reGGA(:,:,1)=obj.wtVel(:,:,1)-<a href="file112.html">repmat</a>(obj.btVel_reGGA(1,:),size(obj.wtVel,1),1); </span><br/><span style="color: #FF0000">  1.28 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 347</span> <span style="color: #000000; background: #FFFFFF;">            wVel_reGGA(:,:,2)=obj.wtVel(:,:,2)-<a href="file112.html">repmat</a>(obj.btVel_reGGA(2,:),size(obj.wtVel,1),1); </span><br/>               <span style="color: #A0A0A0"> 348</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  1.01 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 349</span> <span style="color: #000000; background: #FFFFFF;">            obj.wVelx_reGGA(:,:)=wVel_reGGA(1:obj.maxCells,:,1).*obj.cellsAboveSL; </span><br/><span style="color: #FF0000">  0.94 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 350</span> <span style="color: #000000; background: #FFFFFF;">            obj.wVely_reGGA(:,:)=wVel_reGGA(1:obj.maxCells,:,2).*obj.cellsAboveSL; </span><br/>               <span style="color: #A0A0A0"> 351</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  1.06 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 352</span> <span style="color: #000000; background: #FFFFFF;">            wVel_reVTG(:,:,1)=obj.wtVel(:,:,1)-<a href="file112.html">repmat</a>(obj.btVel_reVTG(1,:),size(obj.wtVel,1),1); </span><br/><span style="color: #FF0000">  1.25 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 353</span> <span style="color: #000000; background: #FFFFFF;">            wVel_reVTG(:,:,2)=obj.wtVel(:,:,2)-<a href="file112.html">repmat</a>(obj.btVel_reVTG(2,:),size(obj.wtVel,1),1); </span><br/>               <span style="color: #A0A0A0"> 354</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.99 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 355</span> <span style="color: #000000; background: #FFFFFF;">            obj.wVelx_reVTG(:,:)=wVel_reVTG(1:obj.maxCells,:,1).*obj.cellsAboveSL; </span><br/><span style="color: #FF0000">  0.82 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 356</span> <span style="color: #000000; background: #FFFFFF;">            obj.wVely_reVTG(:,:)=wVel_reVTG(1:obj.maxCells,:,2).*obj.cellsAboveSL; </span><br/>               <span style="color: #A0A0A0"> 357</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 358</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 359</span> <span style="color: #228B22; background: #FFFFFF;">            %</span><br/>               <span style="color: #A0A0A0"> 360</span> <span style="color: #228B22; background: #FFFFFF;">            % Combine cell size and cell range from transducer for both</span><br/>               <span style="color: #A0A0A0"> 361</span> <span style="color: #228B22; background: #FFFFFF;">            % surface and regular cells</span><br/>               <span style="color: #A0A0A0"> 362</span> <span style="color: #228B22; background: #FFFFFF;">            % ---------------------------------------------------</span><br/><span style="color: #FF0000">  0.55 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 363</span> <span style="color: #000000; background: #FFFFFF;">            cellSizeAll=nan(obj.maxCells,obj.numEns); </span><br/><span style="color: #FF0000">  0.02 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 364</span> <span style="color: #000000; background: #FFFFFF;">            for ii=1:obj.numEns </span><br/>               <span style="color: #A0A0A0"> 365</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/><span style="color: #FF0000">  0.45 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 366</span> <span style="color: #000000; background: #FFFFFF;">                numRegCells=obj.maxCells; </span><br/><span style="color: #FF0000"> 65.43 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 367</span> <a name="Line367"></a><span style="color: #000000; background: #FF9C9C;">                cellSizeAll(1:end,ii)=<a href="file112.html">repmat</a>(regCellSize(ii),numRegCells,1); </span><br/>               <span style="color: #A0A0A0"> 368</span> <span style="color: #228B22; background: #FFFFFF;">                </span><br/><span style="color: #FF0000">  0.73 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 369</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/>               <span style="color: #A0A0A0"> 370</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 371</span> <span style="color: #228B22; background: #FFFFFF;">            % Identify invalid ensembles and invalid cells with valid</span><br/>               <span style="color: #A0A0A0"> 372</span> <span style="color: #228B22; background: #FFFFFF;">            % ensembles</span><br/>               <span style="color: #A0A0A0"> 373</span> <span style="color: #228B22; background: #FFFFFF;">            % --------------------------------------------------------</span><br/><span style="color: #FF0000">  0.32 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 374</span> <span style="color: #000000; background: #FFFFFF;">            obj.idxInvalidEns=[]; </span><br/><span style="color: #FF0000">  0.73 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 375</span> <span style="color: #000000; background: #FFFFFF;">            obj.idxInvalidCells=[]; </span><br/><span style="color: #FF0000">  0.01 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 376</span> <span style="color: #000000; background: #FFFFFF;">            for j=1:obj.numEns </span><br/><span style="color: #FF0000">  7.61 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 377</span> <span style="color: #000000; background: #FFFFFF;">                test=find(~isnan(obj.wVelx(:,j)), 1); </span><br/>               <span style="color: #A0A0A0"> 378</span> <span style="color: #228B22; background: #FFFFFF;">                %</span><br/>               <span style="color: #A0A0A0"> 379</span> <span style="color: #228B22; background: #FFFFFF;">                % If entire ensemble has no valid data the ensemble is</span><br/>               <span style="color: #A0A0A0"> 380</span> <span style="color: #228B22; background: #FFFFFF;">                % marked invalid.</span><br/>               <span style="color: #A0A0A0"> 381</span> <span style="color: #228B22; background: #FFFFFF;">                % -----------------------------------------------------</span><br/><span style="color: #FF0000">  2.74 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 382</span> <span style="color: #000000; background: #FFFFFF;">                if ~isempty(test) </span><br/>               <span style="color: #A0A0A0"> 383</span> <span style="color: #228B22; background: #FFFFFF;">                    %</span><br/>               <span style="color: #A0A0A0"> 384</span> <span style="color: #228B22; background: #FFFFFF;">                    % Identify invalid cells above sidelobe</span><br/>               <span style="color: #A0A0A0"> 385</span> <span style="color: #228B22; background: #FFFFFF;">                    % -------------------------------------</span><br/><span style="color: #FF0000"> 18.06 </span><span style="color: #0000FF">2431000 </span><span style="color: #000000; font-weight: bold"> 386</span> <span style="color: #000000; background: #FFF0F0;">                    temp=find(isnan(obj.wVelx(1:obj.numCells(j),j)))+(j-1).*obj.maxCells; </span><br/><span style="color: #FF0000"> 35.69 </span><span style="color: #0000FF">2431000 </span><span style="color: #000000; font-weight: bold"> 387</span> <a name="Line387"></a><span style="color: #000000; background: #FFD4D4;">                    obj.idxInvalidCells=[obj.idxInvalidCells; temp]; </span><br/><span style="color: #FF0000">  0.04 </span><span style="color: #0000FF"> 187000 </span><span style="color: #000000; font-weight: bold"> 388</span> <span style="color: #228B22; background: #FFFFFF;">                else </span><br/><span style="color: #FF0000">  2.67 </span><span style="color: #0000FF"> 187000 </span><span style="color: #000000; font-weight: bold"> 389</span> <span style="color: #000000; background: #FFFFFF;">                    obj.idxInvalidEns=[obj.idxInvalidEns; j]; </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF"> 187000 </span><span style="color: #000000; font-weight: bold"> 390</span> <span style="color: #000000; background: #FFFFFF;">                end </span><br/><span style="color: #FF0000">  0.65 </span><span style="color: #0000FF">2618000 </span><span style="color: #000000; font-weight: bold"> 391</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/><span style="color: #FF0000">  0.19 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 392</span> <span style="color: #000000; background: #FFFFFF;">            obj.perInvalidEns=(length(obj.idxInvalidEns)./length(obj.depthEns)).*100; </span><br/><span style="color: #FF0000">  1.00 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 393</span> <span style="color: #000000; background: #FFFFFF;">            obj.perInvalidCells=(length(obj.idxInvalidCells)./(length(find(~isnan(obj.wVelx)))+length(obj.idxInvalidCells))).*100; </span><br/>               <span style="color: #A0A0A0"> 394</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/>               <span style="color: #A0A0A0"> 395</span> <span style="color: #228B22; background: #FFFFFF;">            </span><br/><span style="color: #FF0000">  0.36 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 396</span> <span style="color: #000000; background: #FFFFFF;">            if obj.numEns&gt;0 </span><br/><span style="color: #FF0000">  0.11 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 397</span> <span style="color: #000000; background: #FFFFFF;">                obj.validData=1; </span><br/><span style="color: #FF0000">  0.43 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 398</span> <span style="color: #000000; background: #FFFFFF;">                obj.cellSize=cellSizeAll; </span><br/><span style="color: #FF0000">  0.21 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 399</span> <span style="color: #000000; background: #FFFFFF;">                obj.filename=filename; </span><br/><span style="color: #FF0000">  0.41 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 400</span> <span style="color: #000000; background: #FFFFFF;">            end </span><br/><span style="color: #FF0000">  0.05 </span><span style="color: #0000FF">  17000 </span><span style="color: #000000; font-weight: bold"> 401</span> <span style="color: #000000; background: #FFFFFF;">        end </span><br/></pre><p><p>Other subfunctions in this file are not included in this listing.</body></html>